
<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<meta content="Bowling 的笔记本" name="description"/>
<meta content="Bowling" name="author"/>
<link href="https://note.bowling233.top/%E9%AB%98%E6%80%A7%E8%83%BD/%E7%BD%91%E7%BB%9C/" rel="canonical"/>
<link href="../%E6%80%A7%E8%83%BD%E5%88%86%E6%9E%90%E4%B8%8E%E8%B0%83%E4%BC%98/tools/" rel="prev"/>
<link href="algorithm/" rel="next"/>
<link href="../../assets/bowling.svg" rel="icon"/>
<meta content="mkdocs-1.6.1, mkdocs-material-9.6.17" name="generator"/>
<title>高性能网络 - Bowling's TechStack</title>
<link href="../../assets/stylesheets/main.7e37652d.min.css" rel="stylesheet"/>
<link href="../../assets/stylesheets/palette.06af60db.min.css" rel="stylesheet"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
<link href="../../stylesheets/font.css" rel="stylesheet"/>
<link href="../../stylesheets/flink.css" rel="stylesheet"/>
<link href="../../stylesheets/neoteroi-mkdocs.css" rel="stylesheet"/>
<link href="../../stylesheets/custom.css" rel="stylesheet"/>
<link href="https://cdn.jsdelivr.net/npm/lxgw-wenkai-webfont@1.1.0/style.css" rel="stylesheet"/>
<link href="https://cdn.jsdelivr.net/npm/lxgw-wenkai-lite-webfont@1.1.0/style.css" rel="stylesheet"/>
<link href="https://cdn.jsdelivr.net/npm/lxgw-wenkai-tc-webfont@1.0.0/style.css" rel="stylesheet"/>
<link href="https://cdn.jsdelivr.net/npm/lxgw-wenkai-screen-webfont@1.1.0/style.css" rel="stylesheet"/>
<script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
<link href="../../assets/stylesheets/glightbox.min.css" rel="stylesheet"><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style> <script src="../../assets/javascripts/glightbox.min.js"></script></link></head>
<body data-md-color-accent="indigo" data-md-color-primary="indigo" data-md-color-scheme="default" dir="ltr">
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#_1">
          Skip to content
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header" data-md-component="header">
<nav aria-label="Header" class="md-header__inner md-grid">
<a aria-label="Bowling's TechStack" class="md-header__button md-logo" data-md-component="logo" href="../.." title="Bowling's TechStack">
<img alt="logo" src="../../assets/bowling.svg"/>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            Bowling's TechStack
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
            
              高性能网络
            
          </span>
</div>
</div>
</div>
<form class="md-header__option" data-md-component="palette">
<input aria-label="Switch to dark mode" class="md-option" data-md-color-accent="indigo" data-md-color-media="(prefers-color-scheme: light)" data-md-color-primary="indigo" data-md-color-scheme="default" id="__palette_0" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_1" hidden="" title="Switch to dark mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"></path></svg>
</label>
<input aria-label="Switch to light mode" class="md-option" data-md-color-accent="indigo" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-primary="indigo" data-md-color-scheme="slate" id="__palette_1" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_0" hidden="" title="Switch to light mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"></path></svg>
</label>
</form>
<script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
<label class="md-header__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="Search" required="" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg>
</label>
<nav aria-label="Search" class="md-search__options">
<a aria-label="Share" class="md-search__icon md-icon" data-clipboard="" data-clipboard-text="" data-md-component="search-share" href="javascript:void(0)" tabindex="-1" title="Share">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"></path></svg>
</a>
<button aria-label="Clear" class="md-search__icon md-icon" tabindex="-1" title="Clear" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg>
</button>
</nav>
<div class="md-search__suggest" data-md-component="search-suggest"></div>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="" tabindex="0">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            Initializing search
          </div>
<ol class="md-search-result__list" role="presentation"></ol>
</div>
</div>
</div>
</div>
</div>
<div class="md-header__source">
<a class="md-source" data-md-component="source" href="https://github.com/bowling233/TechStack" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4" fill="currentColor"></path></svg>
</div>
<div class="md-source__repository">
    TechStack
  </div>
</a>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<nav aria-label="Tabs" class="md-tabs" data-md-component="tabs">
<div class="md-grid">
<ul class="md-tabs__list">
<li class="md-tabs__item">
<a class="md-tabs__link" href="../..">
        
  
  
    
  
  首页

      </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../links/">
        
  
  
    
  
  友链

      </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../slides/">
          
  
  
    
  
  Slides

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../%E5%85%B6%E4%BB%96/software/">
          
  
  
    
  
  其他

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../%E5%BA%94%E7%94%A8%E9%A2%86%E5%9F%9F/%E4%BA%91%E5%8E%9F%E7%94%9F/">
          
  
  
    
  
  应用领域

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../%E7%A7%91%E7%A0%94/%E8%8D%89%E7%A8%BF/">
          
  
  
    
  
  科研

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../%E7%AE%97%E6%B3%95/%F0%9F%8F%AB%20%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%9F%BA%E7%A1%80/">
          
  
  
    
  
  算法

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../%E7%B3%BB%E7%BB%9F%E5%92%8C%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84/">
          
  
  
    
  
  系统和体系结构

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../%E7%BD%91%E7%BB%9C/%F0%9F%93%92%20%E4%BB%A3%E7%90%86%E4%B8%8E%E8%99%9A%E6%8B%9F%E4%B8%93%E7%94%A8%E7%BD%91/">
          
  
  
    
  
  网络

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../%E8%8D%89%E7%A8%BF/">
          
  
  
    
  
  草稿

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../%E8%AF%AD%E8%A8%80%E5%92%8C%E8%BD%AF%E4%BB%B6%E5%BC%80%E5%8F%91/%E5%B7%A5%E5%85%B7/build/">
          
  
  
    
  
  语言和软件开发

        </a>
</li>
<li class="md-tabs__item md-tabs__item--active">
<a class="md-tabs__link" href="../spack/">
          
  
  
    
  
  高性能

        </a>
</li>
</ul>
</div>
</nav>
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary md-nav--lifted" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="Bowling's TechStack" class="md-nav__button md-logo" data-md-component="logo" href="../.." title="Bowling's TechStack">
<img alt="logo" src="../../assets/bowling.svg"/>
</a>
    Bowling's TechStack
  </label>
<div class="md-nav__source">
<a class="md-source" data-md-component="source" href="https://github.com/bowling233/TechStack" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4" fill="currentColor"></path></svg>
</div>
<div class="md-source__repository">
    TechStack
  </div>
</a>
</div>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../..">
<span class="md-ellipsis">
    首页
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../links/">
<span class="md-ellipsis">
    友链
    
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_3" type="checkbox"/>
<div class="md-nav__link md-nav__container">
<a class="md-nav__link" href="../../slides/">
<span class="md-ellipsis">
    Slides
    
  </span>
</a>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_3_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_3">
<span class="md-nav__icon md-icon"></span>
            Slides
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_4" type="checkbox"/>
<label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
<span class="md-ellipsis">
    其他
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_4_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_4">
<span class="md-nav__icon md-icon"></span>
            其他
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../%E5%85%B6%E4%BB%96/software/">
<span class="md-ellipsis">
    软件使用经验和技巧
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../%E5%85%B6%E4%BB%96/%E6%94%B6%E8%97%8F%E5%A4%B9/">
<span class="md-ellipsis">
    收藏夹
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../%E5%85%B6%E4%BB%96/%E8%87%AA%E5%8A%A8%E5%8C%96/">
<span class="md-ellipsis">
    自动化
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../%E5%85%B6%E4%BB%96/%F0%9F%93%92%20%E5%BF%AB%E6%8D%B7%E9%94%AE/">
<span class="md-ellipsis">
    📒 快捷键
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../%E5%85%B6%E4%BB%96/%F0%9F%93%92%20%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E4%BD%BF%E7%94%A8%E7%BB%8F%E9%AA%8C%E5%92%8C%E6%8A%80%E5%B7%A7/">
<span class="md-ellipsis">
    📒 操作系统使用经验和技巧
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../%E5%85%B6%E4%BB%96/%F0%9F%93%96%20Vim%20%E5%AE%9E%E7%94%A8%E6%8A%80%E5%B7%A7/">
<span class="md-ellipsis">
    📖 Vim 实用技巧
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../%E5%85%B6%E4%BB%96/%F0%9F%93%96%20%E4%BA%BA%E6%9C%88%E7%A5%9E%E8%AF%9D/">
<span class="md-ellipsis">
    📖 人月神话
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../%E5%85%B6%E4%BB%96/%F0%9F%94%97%20%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B1%BB%E7%A7%91%E6%99%AE%E8%A7%86%E9%A2%91/">
<span class="md-ellipsis">
    🔗 计算机类科普视频
    
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_4_9" type="checkbox"/>
<label class="md-nav__link" for="__nav_4_9" id="__nav_4_9_label" tabindex="0">
<span class="md-ellipsis">
    写作
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_4_9_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_4_9">
<span class="md-nav__icon md-icon"></span>
            写作
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../%E5%85%B6%E4%BB%96/%E5%86%99%E4%BD%9C/mkslides/">
<span class="md-ellipsis">
    MkSlides
    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_4_10" type="checkbox"/>
<label class="md-nav__link" for="__nav_4_10" id="__nav_4_10_label" tabindex="0">
<span class="md-ellipsis">
    求职
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_4_10_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_4_10">
<span class="md-nav__icon md-icon"></span>
            求职
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../%E5%85%B6%E4%BB%96/%E6%B1%82%E8%81%8C/code-draft/">
<span class="md-ellipsis">
    手撕代码
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../%E5%85%B6%E4%BB%96/%E6%B1%82%E8%81%8C/code/">
<span class="md-ellipsis">
    手撕代码
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../%E5%85%B6%E4%BB%96/%E6%B1%82%E8%81%8C/interview/">
<span class="md-ellipsis">
    面经
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../%E5%85%B6%E4%BB%96/%E6%B1%82%E8%81%8C/trade/">
<span class="md-ellipsis">
    行业
    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_4_11" type="checkbox"/>
<label class="md-nav__link" for="__nav_4_11" id="__nav_4_11_label" tabindex="0">
<span class="md-ellipsis">
    生活
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_4_11_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_4_11">
<span class="md-nav__icon md-icon"></span>
            生活
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../%E5%85%B6%E4%BB%96/%E7%94%9F%E6%B4%BB/%E4%B8%AA%E4%BA%BA%E5%8F%91%E5%B1%95/">
<span class="md-ellipsis">
    个人发展
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../%E5%85%B6%E4%BB%96/%E7%94%9F%E6%B4%BB/%E6%81%8B%E7%88%B1%E3%80%81%E5%A9%9A%E5%A7%BB%E4%B8%8E%E5%AE%B6%E5%BA%AD/">
<span class="md-ellipsis">
    恋爱、婚姻与家庭
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../%E5%85%B6%E4%BB%96/%E7%94%9F%E6%B4%BB/%E6%9D%82%E4%BA%8B/">
<span class="md-ellipsis">
    杂事
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../%E5%85%B6%E4%BB%96/%E7%94%9F%E6%B4%BB/%E7%A4%BE%E4%BC%9A/">
<span class="md-ellipsis">
    社会
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../%E5%85%B6%E4%BB%96/%E7%94%9F%E6%B4%BB/%F0%9F%93%96%20%E4%BA%B2%E5%AF%86%E5%85%B3%E7%B3%BB%EF%BC%88%E7%AC%AC%208%20%E7%89%88%EF%BC%89/">
<span class="md-ellipsis">
    📖 亲密关系（第 8 版）
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../%E5%85%B6%E4%BB%96/%E7%94%9F%E6%B4%BB/%F0%9F%93%96%20%E4%BA%B2%E5%AF%86%E5%85%B3%E7%B3%BB%EF%BC%9A%E9%80%9A%E5%BE%80%E7%81%B5%E9%AD%82%E7%9A%84%E6%A1%A5%E6%A2%81/">
<span class="md-ellipsis">
    📖 亲密关系：通往灵魂的桥梁
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../%E5%85%B6%E4%BB%96/%E7%94%9F%E6%B4%BB/%F0%9F%93%96%20%E5%88%BB%E6%84%8F%E7%BB%83%E4%B9%A0/">
<span class="md-ellipsis">
    📖 刻意练习
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../%E5%85%B6%E4%BB%96/%E7%94%9F%E6%B4%BB/%F0%9F%93%96%20%E5%8E%9F%E7%94%9F%E5%AE%B6%E5%BA%AD%C2%B7%E5%A9%9A%E6%81%8B%E7%89%88/">
<span class="md-ellipsis">
    📖 原生家庭·婚恋版
    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_4_12" type="checkbox"/>
<label class="md-nav__link" for="__nav_4_12" id="__nav_4_12_label" tabindex="0">
<span class="md-ellipsis">
    课程笔记
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_4_12_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_4_12">
<span class="md-nav__icon md-icon"></span>
            课程笔记
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../%E5%85%B6%E4%BB%96/%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0/%F0%9F%8F%AB%20%E9%A9%AC%E5%85%8B%E6%80%9D%E4%B8%BB%E4%B9%89%E5%8E%9F%E7%90%86%EF%BC%88H%EF%BC%89/">
<span class="md-ellipsis">
    🏫 马克思主义原理（H）
    
  </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_5" type="checkbox"/>
<label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
<span class="md-ellipsis">
    应用领域
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_5_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_5">
<span class="md-nav__icon md-icon"></span>
            应用领域
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_5_1" type="checkbox"/>
<div class="md-nav__link md-nav__container">
<a class="md-nav__link" href="../../%E5%BA%94%E7%94%A8%E9%A2%86%E5%9F%9F/%E4%BA%91%E5%8E%9F%E7%94%9F/">
<span class="md-ellipsis">
    云原生
    
  </span>
</a>
<label class="md-nav__link" for="__nav_5_1" id="__nav_5_1_label" tabindex="0">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_5_1_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_5_1">
<span class="md-nav__icon md-icon"></span>
            云原生
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../%E5%BA%94%E7%94%A8%E9%A2%86%E5%9F%9F/%E4%BA%91%E5%8E%9F%E7%94%9F/k8s/">
<span class="md-ellipsis">
    K8S
    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_5_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_5_2" id="__nav_5_2_label" tabindex="0">
<span class="md-ellipsis">
    人工智能
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_5_2_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_5_2">
<span class="md-nav__icon md-icon"></span>
            人工智能
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../%E5%BA%94%E7%94%A8%E9%A2%86%E5%9F%9F/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD/d2l/">
<span class="md-ellipsis">
    Dive into Deep Learning
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../%E5%BA%94%E7%94%A8%E9%A2%86%E5%9F%9F/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD/llm_infra/">
<span class="md-ellipsis">
    LLM Infra
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../%E5%BA%94%E7%94%A8%E9%A2%86%E5%9F%9F/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD/pytorch/">
<span class="md-ellipsis">
    PyTorch
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../%E5%BA%94%E7%94%A8%E9%A2%86%E5%9F%9F/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD/%E4%B8%AA%E4%BA%BA%E7%AC%94%E8%AE%B0/">
<span class="md-ellipsis">
    📒 人工智能
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../%E5%BA%94%E7%94%A8%E9%A2%86%E5%9F%9F/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD/%F0%9F%93%96%20Dive%20into%20Deep%20Learning/">
<span class="md-ellipsis">
    📖 Dive into Deep Learning
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../%E5%BA%94%E7%94%A8%E9%A2%86%E5%9F%9F/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD/%F0%9F%93%96%20PyTorch%20%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E5%AE%9E%E6%88%98/">
<span class="md-ellipsis">
    📖 PyTorch 深度学习实战
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../%E5%BA%94%E7%94%A8%E9%A2%86%E5%9F%9F/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD/%F0%9F%93%96%20%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/">
<span class="md-ellipsis">
    📖 深度学习
    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_5_3" type="checkbox"/>
<div class="md-nav__link md-nav__container">
<a class="md-nav__link" href="../../%E5%BA%94%E7%94%A8%E9%A2%86%E5%9F%9F/%E6%95%B0%E6%8D%AE%E5%BA%93/">
<span class="md-ellipsis">
    数据库
    
  </span>
</a>
<label class="md-nav__link" for="__nav_5_3" id="__nav_5_3_label" tabindex="0">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_5_3_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_5_3">
<span class="md-nav__icon md-icon"></span>
            数据库
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../%E5%BA%94%E7%94%A8%E9%A2%86%E5%9F%9F/%E6%95%B0%E6%8D%AE%E5%BA%93/%F0%9F%93%92%20ClickHouse/">
<span class="md-ellipsis">
    ClickHouse
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../%E5%BA%94%E7%94%A8%E9%A2%86%E5%9F%9F/%E6%95%B0%E6%8D%AE%E5%BA%93/%F0%9F%93%92%20ElasticSearch/">
<span class="md-ellipsis">
    📒 ElasticSearch
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../%E5%BA%94%E7%94%A8%E9%A2%86%E5%9F%9F/%E6%95%B0%E6%8D%AE%E5%BA%93/%F0%9F%93%92%20%E6%95%B0%E6%8D%AE%E5%BA%93%E7%BC%96%E7%A8%8B/">
<span class="md-ellipsis">
    📒 数据库编程
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../%E5%BA%94%E7%94%A8%E9%A2%86%E5%9F%9F/%E6%95%B0%E6%8D%AE%E5%BA%93/%F0%9F%93%92%20%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%90%E7%BB%B4/">
<span class="md-ellipsis">
    📒 数据库运维
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../%E5%BA%94%E7%94%A8%E9%A2%86%E5%9F%9F/%E6%95%B0%E6%8D%AE%E5%BA%93/%F0%9F%93%96%20%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E6%A6%82%E5%BF%B5/">
<span class="md-ellipsis">
    📖 数据库系统概念
    
  </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_6" type="checkbox"/>
<label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
<span class="md-ellipsis">
    科研
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_6_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_6">
<span class="md-nav__icon md-icon"></span>
            科研
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../%E7%A7%91%E7%A0%94/%E8%8D%89%E7%A8%BF/">
<span class="md-ellipsis">
    草稿
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../%E7%A7%91%E7%A0%94/%F0%9F%93%92%20%E7%A7%91%E7%A0%94%E5%86%99%E4%BD%9C/">
<span class="md-ellipsis">
    📒 科研写作
    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_7" type="checkbox"/>
<label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
<span class="md-ellipsis">
    算法
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_7_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_7">
<span class="md-nav__icon md-icon"></span>
            算法
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../%E7%AE%97%E6%B3%95/%F0%9F%8F%AB%20%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%9F%BA%E7%A1%80/">
<span class="md-ellipsis">
    🏫 数据结构基础
    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_8" type="checkbox"/>
<div class="md-nav__link md-nav__container">
<a class="md-nav__link" href="../../%E7%B3%BB%E7%BB%9F%E5%92%8C%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84/">
<span class="md-ellipsis">
    系统和体系结构
    
  </span>
</a>
<label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_8_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_8">
<span class="md-nav__icon md-icon"></span>
            系统和体系结构
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../%E7%B3%BB%E7%BB%9F%E5%92%8C%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84/ISA/">
<span class="md-ellipsis">
    ISA
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../%E7%B3%BB%E7%BB%9F%E5%92%8C%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84/nvidia-driver/">
<span class="md-ellipsis">
    NVIDIA
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../%E7%B3%BB%E7%BB%9F%E5%92%8C%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84/%E6%95%B0%E5%AD%97%E7%94%B5%E8%B7%AF/">
<span class="md-ellipsis">
    数字电路
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../%E7%B3%BB%E7%BB%9F%E5%92%8C%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84/%F0%9F%93%96%20%E6%80%BB%E7%BA%BF/">
<span class="md-ellipsis">
    📖 总线
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../%E7%B3%BB%E7%BB%9F%E5%92%8C%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84/%F0%9F%93%96%20%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F/">
<span class="md-ellipsis">
    📖 深入理解计算机系统
    
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_8_7" type="checkbox"/>
<div class="md-nav__link md-nav__container">
<a class="md-nav__link" href="../../%E7%B3%BB%E7%BB%9F%E5%92%8C%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84/Linux/">
<span class="md-ellipsis">
    Linux
    
  </span>
</a>
<label class="md-nav__link" for="__nav_8_7" id="__nav_8_7_label" tabindex="0">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_8_7_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_8_7">
<span class="md-nav__icon md-icon"></span>
            Linux
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../%E7%B3%BB%E7%BB%9F%E5%92%8C%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84/Linux/pkg/">
<span class="md-ellipsis">
    发行版与包管理
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../%E7%B3%BB%E7%BB%9F%E5%92%8C%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84/Linux/%E5%90%AF%E5%8A%A8%E8%BF%87%E7%A8%8B/">
<span class="md-ellipsis">
    启动过程
    
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_8_7_4" type="checkbox"/>
<div class="md-nav__link md-nav__container">
<a class="md-nav__link" href="../../%E7%B3%BB%E7%BB%9F%E5%92%8C%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84/Linux/%E5%86%85%E6%A0%B8%E4%B8%8E%E9%A9%B1%E5%8A%A8/">
<span class="md-ellipsis">
    内核与驱动
    
  </span>
</a>
<label class="md-nav__link" for="__nav_8_7_4" id="__nav_8_7_4_label" tabindex="0">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_8_7_4_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_8_7_4">
<span class="md-nav__icon md-icon"></span>
            内核与驱动
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../%E7%B3%BB%E7%BB%9F%E5%92%8C%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84/Linux/%E5%86%85%E6%A0%B8%E4%B8%8E%E9%A9%B1%E5%8A%A8/ebpf/">
<span class="md-ellipsis">
    eBPF
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../%E7%B3%BB%E7%BB%9F%E5%92%8C%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84/Linux/%E5%86%85%E6%A0%B8%E4%B8%8E%E9%A9%B1%E5%8A%A8/%F0%9F%93%96%20Linux%20Device%20Drivers%20%283rd%29/">
<span class="md-ellipsis">
    📖 Linux Device Drivers (3rd)
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../%E7%B3%BB%E7%BB%9F%E5%92%8C%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84/Linux/%E5%86%85%E6%A0%B8%E4%B8%8E%E9%A9%B1%E5%8A%A8/%F0%9F%93%96%20Linux%20Kernel%20Development%20%283rd%29/">
<span class="md-ellipsis">
    📖 Linux Kernel Development (3rd)
    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_8_7_5" type="checkbox"/>
<div class="md-nav__link md-nav__container">
<a class="md-nav__link" href="../../%E7%B3%BB%E7%BB%9F%E5%92%8C%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84/Linux/%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/">
<span class="md-ellipsis">
    文件系统
    
  </span>
</a>
<label class="md-nav__link" for="__nav_8_7_5" id="__nav_8_7_5_label" tabindex="0">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_8_7_5_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_8_7_5">
<span class="md-nav__icon md-icon"></span>
            文件系统
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../%E7%B3%BB%E7%BB%9F%E5%92%8C%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84/Linux/%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/%F0%9F%93%92%20%E5%86%85%E6%A0%B8%E6%BA%90%E7%A0%81%EF%BC%9ANFS/">
<span class="md-ellipsis">
    📒 内核源码：NFS
    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_8_7_6" type="checkbox"/>
<label class="md-nav__link" for="__nav_8_7_6" id="__nav_8_7_6_label" tabindex="0">
<span class="md-ellipsis">
    源码笔记
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_8_7_6_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_8_7_6">
<span class="md-nav__icon md-icon"></span>
            源码笔记
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../%E7%B3%BB%E7%BB%9F%E5%92%8C%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84/Linux/%E6%BA%90%E7%A0%81%E7%AC%94%E8%AE%B0/bonding/">
<span class="md-ellipsis">
    drivers/net/bonding
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../%E7%B3%BB%E7%BB%9F%E5%92%8C%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84/Linux/%E6%BA%90%E7%A0%81%E7%AC%94%E8%AE%B0/bpftrace/">
<span class="md-ellipsis">
    bpftrace
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../%E7%B3%BB%E7%BB%9F%E5%92%8C%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84/Linux/%E6%BA%90%E7%A0%81%E7%AC%94%E8%AE%B0/systemd-networkd/">
<span class="md-ellipsis">
    systemd-networkd
    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_8_7_7" type="checkbox"/>
<div class="md-nav__link md-nav__container">
<a class="md-nav__link" href="../../%E7%B3%BB%E7%BB%9F%E5%92%8C%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84/Linux/%E7%BD%91%E7%BB%9C/">
<span class="md-ellipsis">
    网络
    
  </span>
</a>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_8_7_7_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_8_7_7">
<span class="md-nav__icon md-icon"></span>
            网络
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_8_8" type="checkbox"/>
<div class="md-nav__link md-nav__container">
<a class="md-nav__link" href="../../%E7%B3%BB%E7%BB%9F%E5%92%8C%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84/%E5%AE%B9%E5%99%A8%E5%92%8C%E8%99%9A%E6%8B%9F%E5%8C%96/">
<span class="md-ellipsis">
    容器和虚拟化
    
  </span>
</a>
<label class="md-nav__link" for="__nav_8_8" id="__nav_8_8_label" tabindex="0">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_8_8_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_8_8">
<span class="md-nav__icon md-icon"></span>
            容器和虚拟化
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../%E7%B3%BB%E7%BB%9F%E5%92%8C%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84/%E5%AE%B9%E5%99%A8%E5%92%8C%E8%99%9A%E6%8B%9F%E5%8C%96/apptainer/">
<span class="md-ellipsis">
    Apptainer/Singularity
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../%E7%B3%BB%E7%BB%9F%E5%92%8C%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84/%E5%AE%B9%E5%99%A8%E5%92%8C%E8%99%9A%E6%8B%9F%E5%8C%96/docker/">
<span class="md-ellipsis">
    Docker
    
  </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_9" type="checkbox"/>
<label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
<span class="md-ellipsis">
    网络
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_9_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_9">
<span class="md-nav__icon md-icon"></span>
            网络
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../%E7%BD%91%E7%BB%9C/%F0%9F%93%92%20%E4%BB%A3%E7%90%86%E4%B8%8E%E8%99%9A%E6%8B%9F%E4%B8%93%E7%94%A8%E7%BD%91/">
<span class="md-ellipsis">
    📒 代理与虚拟专用网
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../%E7%BD%91%E7%BB%9C/%F0%9F%93%92%20%E7%89%A9%E7%90%86%E5%92%8C%E6%95%B0%E6%8D%AE%E9%93%BE%E8%B7%AF%E5%B1%82/">
<span class="md-ellipsis">
    📒 物理和数据链路层
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../%E7%BD%91%E7%BB%9C/%F0%9F%93%92%20%E7%BD%91%E7%BB%9C%E7%AC%94%E8%AE%B0/">
<span class="md-ellipsis">
    📒 网络笔记
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../%E7%BD%91%E7%BB%9C/%F0%9F%93%96%20Head%20First%20HTML/">
<span class="md-ellipsis">
    📖 Head First HTML
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../%E7%BD%91%E7%BB%9C/%F0%9F%93%96%20%E5%9B%BE%E8%A7%A3%20HTTP/">
<span class="md-ellipsis">
    📖 图解 HTTP
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../%E7%BD%91%E7%BB%9C/%F0%9F%93%96%20%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%EF%BC%9A%E8%87%AA%E9%A1%B6%E5%90%91%E4%B8%8B%E6%96%B9%E6%B3%95/">
<span class="md-ellipsis">
    📖 计算机网络：自顶向下方法
    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_10" type="checkbox"/>
<div class="md-nav__link md-nav__container">
<a class="md-nav__link" href="../../%E8%8D%89%E7%A8%BF/">
<span class="md-ellipsis">
    草稿
    
  </span>
</a>
<label class="md-nav__link" for="__nav_10" id="__nav_10_label" tabindex="0">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_10_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_10">
<span class="md-nav__icon md-icon"></span>
            草稿
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../%E8%8D%89%E7%A8%BF/ZFS/">
<span class="md-ellipsis">
    ZFS
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../%E8%8D%89%E7%A8%BF/draft/">
<span class="md-ellipsis">
    零散笔记
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../%E8%8D%89%E7%A8%BF/lvm/">
<span class="md-ellipsis">
    Logical Volume Manager
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../%E8%8D%89%E7%A8%BF/%E5%88%86%E5%B8%83%E5%BC%8F%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/">
<span class="md-ellipsis">
    分布式文件系统
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../%E8%8D%89%E7%A8%BF/%F0%9F%93%92%20%E4%B8%B4%E6%97%B6%E7%AC%94%E8%AE%B0/">
<span class="md-ellipsis">
    📒 临时笔记
    
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_10_7" type="checkbox"/>
<label class="md-nav__link" for="__nav_10_7" id="__nav_10_7_label" tabindex="0">
<span class="md-ellipsis">
    HPC
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_10_7_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_10_7">
<span class="md-nav__icon md-icon"></span>
            HPC
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../%E8%8D%89%E7%A8%BF/HPC/%F0%9F%93%92%20%E6%80%A7%E8%83%BD%E5%88%86%E6%9E%90/">
<span class="md-ellipsis">
    📒 性能分析
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../%E8%8D%89%E7%A8%BF/HPC/%F0%9F%93%92%20%E8%AE%BF%E5%AD%98%E4%BC%98%E5%8C%96/">
<span class="md-ellipsis">
    📒 访存优化
    
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_10_7_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_10_7_3" id="__nav_10_7_3_label" tabindex="0">
<span class="md-ellipsis">
    工具
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_10_7_3_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_10_7_3">
<span class="md-nav__icon md-icon"></span>
            工具
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../%E8%8D%89%E7%A8%BF/HPC/%E5%B7%A5%E5%85%B7/%E7%BC%96%E8%AF%91%E5%A5%97%E4%BB%B6/">
<span class="md-ellipsis">
    编译套件
    
  </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_10_8" type="checkbox"/>
<div class="md-nav__link md-nav__container">
<a class="md-nav__link" href="../../%E8%8D%89%E7%A8%BF/RFC/">
<span class="md-ellipsis">
    RFC
    
  </span>
</a>
<label class="md-nav__link" for="__nav_10_8" id="__nav_10_8_label" tabindex="0">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_10_8_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_10_8">
<span class="md-nav__icon md-icon"></span>
            RFC
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../%E8%8D%89%E7%A8%BF/RFC/4506%20XDR/">
<span class="md-ellipsis">
    RFC 4506 - XDR: External Data Representation Standard
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../%E8%8D%89%E7%A8%BF/RFC/5531%20RPC/">
<span class="md-ellipsis">
    RFC 5531 - RPC: Remote Procedure Call Protocol Specification Version 2
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../%E8%8D%89%E7%A8%BF/RFC/5661%20NFSv4.1/">
<span class="md-ellipsis">
    RFC 5661 - Network File System (NFS) Version 4 Minor Version 1 Protocol
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../%E8%8D%89%E7%A8%BF/RFC/7530%20NFSv4/">
<span class="md-ellipsis">
    RFC 7530 - Network File System (NFS) Version 4 Protocol
    
  </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_11" type="checkbox"/>
<label class="md-nav__link" for="__nav_11" id="__nav_11_label" tabindex="0">
<span class="md-ellipsis">
    语言和软件开发
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_11_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_11">
<span class="md-nav__icon md-icon"></span>
            语言和软件开发
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_11_1" type="checkbox"/>
<label class="md-nav__link" for="__nav_11_1" id="__nav_11_1_label" tabindex="0">
<span class="md-ellipsis">
    工具
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_11_1_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_11_1">
<span class="md-nav__icon md-icon"></span>
            工具
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../%E8%AF%AD%E8%A8%80%E5%92%8C%E8%BD%AF%E4%BB%B6%E5%BC%80%E5%8F%91/%E5%B7%A5%E5%85%B7/build/">
<span class="md-ellipsis">
    构建
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../%E8%AF%AD%E8%A8%80%E5%92%8C%E8%BD%AF%E4%BB%B6%E5%BC%80%E5%8F%91/%E5%B7%A5%E5%85%B7/debug/">
<span class="md-ellipsis">
    调试
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../%E8%AF%AD%E8%A8%80%E5%92%8C%E8%BD%AF%E4%BB%B6%E5%BC%80%E5%8F%91/%E5%B7%A5%E5%85%B7/git/">
<span class="md-ellipsis">
    代码管理
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../%E8%AF%AD%E8%A8%80%E5%92%8C%E8%BD%AF%E4%BB%B6%E5%BC%80%E5%8F%91/%E5%B7%A5%E5%85%B7/shell/">
<span class="md-ellipsis">
    Shell
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../%E8%AF%AD%E8%A8%80%E5%92%8C%E8%BD%AF%E4%BB%B6%E5%BC%80%E5%8F%91/%E5%B7%A5%E5%85%B7/test/">
<span class="md-ellipsis">
    测试
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../%E8%AF%AD%E8%A8%80%E5%92%8C%E8%BD%AF%E4%BB%B6%E5%BC%80%E5%8F%91/%E5%B7%A5%E5%85%B7/%F0%9F%93%92%20%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/">
<span class="md-ellipsis">
    📒 开发工具
    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_11_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_11_2" id="__nav_11_2_label" tabindex="0">
<span class="md-ellipsis">
    编译
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_11_2_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_11_2">
<span class="md-nav__icon md-icon"></span>
            编译
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../%E8%AF%AD%E8%A8%80%E5%92%8C%E8%BD%AF%E4%BB%B6%E5%BC%80%E5%8F%91/%E7%BC%96%E8%AF%91/compiler/">
<span class="md-ellipsis">
    编译原理
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../%E8%AF%AD%E8%A8%80%E5%92%8C%E8%BD%AF%E4%BB%B6%E5%BC%80%E5%8F%91/%E7%BC%96%E8%AF%91/gnu/">
<span class="md-ellipsis">
    GNU Compiler Collection
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../%E8%AF%AD%E8%A8%80%E5%92%8C%E8%BD%AF%E4%BB%B6%E5%BC%80%E5%8F%91/%E7%BC%96%E8%AF%91/llvm/">
<span class="md-ellipsis">
    LLVM
    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_11_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_11_3" id="__nav_11_3_label" tabindex="0">
<span class="md-ellipsis">
    语言
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_11_3_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_11_3">
<span class="md-nav__icon md-icon"></span>
            语言
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../%E8%AF%AD%E8%A8%80%E5%92%8C%E8%BD%AF%E4%BB%B6%E5%BC%80%E5%8F%91/%E8%AF%AD%E8%A8%80/C/">
<span class="md-ellipsis">
    C
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../%E8%AF%AD%E8%A8%80%E5%92%8C%E8%BD%AF%E4%BB%B6%E5%BC%80%E5%8F%91/%E8%AF%AD%E8%A8%80/Python/">
<span class="md-ellipsis">
    Python
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../%E8%AF%AD%E8%A8%80%E5%92%8C%E8%BD%AF%E4%BB%B6%E5%BC%80%E5%8F%91/%E8%AF%AD%E8%A8%80/flutter/">
<span class="md-ellipsis">
    Flutter
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../%E8%AF%AD%E8%A8%80%E5%92%8C%E8%BD%AF%E4%BB%B6%E5%BC%80%E5%8F%91/%E8%AF%AD%E8%A8%80/go/">
<span class="md-ellipsis">
    Go
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../%E8%AF%AD%E8%A8%80%E5%92%8C%E8%BD%AF%E4%BB%B6%E5%BC%80%E5%8F%91/%E8%AF%AD%E8%A8%80/%F0%9F%93%92%20C%20%E5%92%8C%20C%2B%2B%20%E9%AB%98%E7%BA%A7%E8%AF%9D%E9%A2%98/">
<span class="md-ellipsis">
    📒 C 和 C++ 高级话题
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../%E8%AF%AD%E8%A8%80%E5%92%8C%E8%BD%AF%E4%BB%B6%E5%BC%80%E5%8F%91/%E8%AF%AD%E8%A8%80/%F0%9F%93%92%20%E4%BB%A3%E7%A0%81%E9%A3%8E%E6%A0%BC/">
<span class="md-ellipsis">
    📒 代码风格
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../%E8%AF%AD%E8%A8%80%E5%92%8C%E8%BD%AF%E4%BB%B6%E5%BC%80%E5%8F%91/%E8%AF%AD%E8%A8%80/%F0%9F%93%96%20C%2B%2B%20Primer/">
<span class="md-ellipsis">
    📖 C++ Primer
    
  </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_12" type="checkbox"/>
<label class="md-nav__link" for="__nav_12" id="__nav_12_label" tabindex="">
<span class="md-ellipsis">
    高性能
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="true" aria-labelledby="__nav_12_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_12">
<span class="md-nav__icon md-icon"></span>
            高性能
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../spack/">
<span class="md-ellipsis">
    Spack
    
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_12_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_12_2" id="__nav_12_2_label" tabindex="">
<span class="md-ellipsis">
    并行程序设计
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_12_2_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_12_2">
<span class="md-nav__icon md-icon"></span>
            并行程序设计
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../%E5%B9%B6%E8%A1%8C%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1/C%2B%2B%20%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/">
<span class="md-ellipsis">
    C++ 并发编程
    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_12_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_12_3" id="__nav_12_3_label" tabindex="">
<span class="md-ellipsis">
    性能分析与调优
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_12_3_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_12_3">
<span class="md-nav__icon md-icon"></span>
            性能分析与调优
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../%E6%80%A7%E8%83%BD%E5%88%86%E6%9E%90%E4%B8%8E%E8%B0%83%E4%BC%98/intro/">
<span class="md-ellipsis">
    性能分析简介
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../%E6%80%A7%E8%83%BD%E5%88%86%E6%9E%90%E4%B8%8E%E8%B0%83%E4%BC%98/tools/">
<span class="md-ellipsis">
    性能分析工具
    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_12_4" type="checkbox"/>
<div class="md-nav__link md-nav__container">
<a class="md-nav__link md-nav__link--active" href="./">
<span class="md-ellipsis">
    网络
    
  </span>
</a>
<label class="md-nav__link md-nav__link--active" for="__nav_12_4" id="__nav_12_4_label" tabindex="">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-expanded="true" aria-labelledby="__nav_12_4_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_12_4">
<span class="md-nav__icon md-icon"></span>
            网络
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="algorithm/">
<span class="md-ellipsis">
    通信算法
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="interconnection/">
<span class="md-ellipsis">
    互联网络
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="mpi/">
<span class="md-ellipsis">
    MPI
    
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_12_4_5" type="checkbox"/>
<label class="md-nav__link" for="__nav_12_4_5" id="__nav_12_4_5_label" tabindex="0">
<span class="md-ellipsis">
    源码阅读
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_12_4_5_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_12_4_5">
<span class="md-nav__icon md-icon"></span>
            源码阅读
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB/libfabric/">
<span class="md-ellipsis">
    libfabric
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB/rdma-core/">
<span class="md-ellipsis">
    rdma-core 与 linux/drivers/infiniband
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB/ucx/">
<span class="md-ellipsis">
    UCX
    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_12_4_6" type="checkbox"/>
<label class="md-nav__link" for="__nav_12_4_6" id="__nav_12_4_6_label" tabindex="0">
<span class="md-ellipsis">
    编程
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_12_4_6_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_12_4_6">
<span class="md-nav__icon md-icon"></span>
            编程
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="%E7%BC%96%E7%A8%8B/dpdk/">
<span class="md-ellipsis">
    DPDK
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="%E7%BC%96%E7%A8%8B/ibverbs/">
<span class="md-ellipsis">
    IB Verbs
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="%E7%BC%96%E7%A8%8B/mlx5dv/">
<span class="md-ellipsis">
    mlx5dv 与 DevX
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="%E7%BC%96%E7%A8%8B/rdmacm/">
<span class="md-ellipsis">
    RDMA CM
    
  </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#rdma">
<span class="md-ellipsis">
      RDMA
    </span>
</a>
<nav aria-label="RDMA" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#extended-reliable-connection-xrc">
<span class="md-ellipsis">
      eXtended Reliable Connection (XRC)
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#_2">
<span class="md-ellipsis">
      其他问题
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#_3">
<span class="md-ellipsis">
      软件栈
    </span>
</a>
<nav aria-label="软件栈" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#_4">
<span class="md-ellipsis">
      实用工具
    </span>
</a>
<nav aria-label="实用工具" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#infiniband-diags">
<span class="md-ellipsis">
      infiniband-diags
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#opensm">
<span class="md-ellipsis">
      OpenSM
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#mstflint">
<span class="md-ellipsis">
      mstflint
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#hca">
<span class="md-ellipsis">
      HCA 卡
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#dhcp-for-ipoib">
<span class="md-ellipsis">
      DHCP for IPoIB
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#benchmark">
<span class="md-ellipsis">
      Benchmark
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#iproute2">
<span class="md-ellipsis">
      iproute2
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#_5">
<span class="md-ellipsis">
      其他
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#_6">
<span class="md-ellipsis">
      用户空间库
    </span>
</a>
<nav aria-label="用户空间库" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#linux-infiniband">
<span class="md-ellipsis">
      Linux InfiniBand 软件结构
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#rdma-verb">
<span class="md-ellipsis">
      RDMA Verb
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#infiniband-verb">
<span class="md-ellipsis">
      InfiniBand Verb
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ipoib">
<span class="md-ellipsis">
      IPoIB
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#nfs-over-rdma">
<span class="md-ellipsis">
      NFS over RDMA
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#_7">
<span class="md-ellipsis">
      内核子系统
    </span>
</a>
<nav aria-label="内核子系统" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#hw">
<span class="md-ellipsis">
      硬件驱动 hw
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#sw">
<span class="md-ellipsis">
      软件驱动 sw
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ulp">
<span class="md-ellipsis">
      上层协议 ulp
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#core">
<span class="md-ellipsis">
      核心模块 core
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#_8">
<span class="md-ellipsis">
      硬件
    </span>
</a>
<nav aria-label="硬件" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#infiniband">
<span class="md-ellipsis">
      InfiniBand
    </span>
</a>
<nav aria-label="InfiniBand" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#infiniband_1">
<span class="md-ellipsis">
      InfiniBand 硬件
    </span>
</a>
<nav aria-label="InfiniBand 硬件" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#host-channel-adapter">
<span class="md-ellipsis">
      Host Channel Adapter
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#_9">
<span class="md-ellipsis">
      线缆
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#_10">
<span class="md-ellipsis">
      交换机
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#infiniband_2">
<span class="md-ellipsis">
      InfiniBand 协议栈
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#roce">
<span class="md-ellipsis">
      RoCE
    </span>
</a>
<nav aria-label="RoCE" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#soft-roce">
<span class="md-ellipsis">
      Soft-RoCE
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#iwarp">
<span class="md-ellipsis">
      iWARP
    </span>
</a>
<nav aria-label="iWARP" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#soft-iwarp">
<span class="md-ellipsis">
      Soft-iWARP
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#_11">
<span class="md-ellipsis">
      传统网络栈的不足
    </span>
</a>
<nav aria-label="传统网络栈的不足" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#non-blocking-socket">
<span class="md-ellipsis">
      Non-blocking Socket
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#socket">
<span class="md-ellipsis">
      Socket 的不足
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#rdma_1">
<span class="md-ellipsis">
      RDMA 基本概念
    </span>
</a>
<nav aria-label="RDMA 基本概念" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#_12">
<span class="md-ellipsis">
      注册内存区域
    </span>
</a>
<nav aria-label="注册内存区域" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#_13">
<span class="md-ellipsis">
      交换信息
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#_14">
<span class="md-ellipsis">
      异步通信
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#_15">
<span class="md-ellipsis">
      访存模式
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#_16">
<span class="md-ellipsis">
      内核旁路
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#_17">
<span class="md-ellipsis">
      实用工具
    </span>
</a>
<nav aria-label="实用工具" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#perftest">
<span class="md-ellipsis">
      perftest
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#_18">
<span class="md-ellipsis">
      通信框架
    </span>
</a>
<nav aria-label="通信框架" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#nccl">
<span class="md-ellipsis">
      NCCL
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#hccl">
<span class="md-ellipsis">
      HCCL
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#tccl">
<span class="md-ellipsis">
      TCCL
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#_19">
<span class="md-ellipsis">
      文献阅读
    </span>
</a>
<nav aria-label="文献阅读" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#eurosys20-strom-smart-remote-memory">
<span class="md-ellipsis">
      EuroSys’20 StRoM: Smart Remote Memory
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#_20">
<span class="md-ellipsis">
      问题记录
    </span>
</a>
<nav aria-label="问题记录" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#_21">
<span class="md-ellipsis">
      编译相关
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#_22">
<span class="md-ellipsis">
      其他相关知识
    </span>
</a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<a class="md-content__button md-icon" href="https://github.com/bowling233/TechStack/blob/master/docs/高性能/网络/index.md" rel="edit" title="Edit this page">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"></path></svg>
</a>
<h1 id="_1">高性能网络<a class="headerlink" href="#_1" title="Permanent link">¶</a></h1>
<p>欢迎来到 HPN 的世界！</p>
<p>随着 AI 的发展和数据中心规模的不断扩大，高性能网络的需求日益增长。本篇笔记是对高性能网络方向的综述。我们将梳理 HPN 的软硬件层次结构，从整体上把握 HPN 的技术和知识体系。至于具体的内容，请查看其他子笔记。</p>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="auto" href="index.assets/hpn.drawio"><div class="mxgraph" data-mxgraph='{"toolbar": "zoom", "tooltips": "1", "border": 5, "resize": "1", "edit": "_blank", "xml": "&lt;mxfile host=\"65bd71144e\"&gt;\n    &lt;diagram name=\"\u7b2c 1 \u9875\" id=\"ebd0SypMFmkXTo0tFTf7\"&gt;\n        &lt;mxGraphModel dx=\"1571\" dy=\"786\" grid=\"1\" gridSize=\"10\" guides=\"1\" tooltips=\"1\" connect=\"1\" arrows=\"1\" fold=\"1\" page=\"0\" pageScale=\"1\" pageWidth=\"827\" pageHeight=\"1169\" math=\"0\" shadow=\"0\"&gt;\n            &lt;root&gt;\n                &lt;mxCell id=\"0\"/&gt;\n                &lt;mxCell id=\"1\" parent=\"0\"/&gt;\n                &lt;mxCell id=\"30\" value=\"hw\" style=\"rounded=0;whiteSpace=wrap;html=1;verticalAlign=middle;dashed=1;dashPattern=8 8;align=left;fontSize=24;\" parent=\"1\" vertex=\"1\"&gt;\n                    &lt;mxGeometry x=\"100\" y=\"905\" width=\"720\" height=\"205\" as=\"geometry\"/&gt;\n                &lt;/mxCell&gt;\n                &lt;mxCell id=\"20\" value=\"Infiniband\" style=\"rounded=0;whiteSpace=wrap;html=1;verticalAlign=middle;align=left;\" parent=\"1\" vertex=\"1\"&gt;\n                    &lt;mxGeometry x=\"152\" y=\"932\" width=\"618\" height=\"30\" as=\"geometry\"/&gt;\n                &lt;/mxCell&gt;\n                &lt;mxCell id=\"47\" style=\"edgeStyle=none;html=1;\" edge=\"1\" parent=\"1\" source=\"5\" target=\"7\"&gt;\n                    &lt;mxGeometry relative=\"1\" as=\"geometry\"/&gt;\n                &lt;/mxCell&gt;\n                &lt;mxCell id=\"5\" value=\"rdma-core\" style=\"rounded=0;whiteSpace=wrap;html=1;verticalAlign=top;dashed=1;dashPattern=8 8;\" parent=\"1\" vertex=\"1\"&gt;\n                    &lt;mxGeometry x=\"100\" y=\"649\" width=\"260\" height=\"101\" as=\"geometry\"/&gt;\n                &lt;/mxCell&gt;\n                &lt;mxCell id=\"Q0vGUsLp9HMjobRbkaUK-1\" value=\"Application (HPC, AI, ML, BigData)\" style=\"rounded=0;whiteSpace=wrap;html=1;\" parent=\"1\" vertex=\"1\"&gt;\n                    &lt;mxGeometry x=\"100\" y=\"280\" width=\"720\" height=\"40\" as=\"geometry\"/&gt;\n                &lt;/mxCell&gt;\n                &lt;mxCell id=\"Q0vGUsLp9HMjobRbkaUK-2\" value=\"MPI (Message Passing Interface)\" style=\"rounded=0;whiteSpace=wrap;html=1;verticalAlign=top;\" parent=\"1\" vertex=\"1\"&gt;\n                    &lt;mxGeometry x=\"100\" y=\"340\" width=\"190\" height=\"170\" as=\"geometry\"/&gt;\n                &lt;/mxCell&gt;\n                &lt;mxCell id=\"Q0vGUsLp9HMjobRbkaUK-3\" value=\"&amp;lt;div&amp;gt;Parallel&amp;lt;/div&amp;gt;Programming&amp;lt;div&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;Framework&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;\" style=\"text;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontStyle=1;fontSize=24;\" parent=\"1\" vertex=\"1\"&gt;\n                    &lt;mxGeometry x=\"-100\" y=\"410\" width=\"60\" height=\"30\" as=\"geometry\"/&gt;\n                &lt;/mxCell&gt;\n                &lt;mxCell id=\"Q0vGUsLp9HMjobRbkaUK-5\" value=\"OpenMPI\" style=\"rounded=0;whiteSpace=wrap;html=1;autosize=1;\" parent=\"1\" vertex=\"1\"&gt;\n                    &lt;mxGeometry x=\"115\" y=\"370\" width=\"70\" height=\"30\" as=\"geometry\"/&gt;\n                &lt;/mxCell&gt;\n                &lt;mxCell id=\"Q0vGUsLp9HMjobRbkaUK-6\" value=\"Intel MPI\" style=\"rounded=0;whiteSpace=wrap;html=1;autosize=1;\" parent=\"1\" vertex=\"1\"&gt;\n                    &lt;mxGeometry x=\"200\" y=\"390\" width=\"70\" height=\"30\" as=\"geometry\"/&gt;\n                &lt;/mxCell&gt;\n                &lt;mxCell id=\"Q0vGUsLp9HMjobRbkaUK-11\" style=\"edgeStyle=none;shape=connector;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;\" parent=\"1\" source=\"Q0vGUsLp9HMjobRbkaUK-7\" target=\"Q0vGUsLp9HMjobRbkaUK-10\" edge=\"1\"&gt;\n                    &lt;mxGeometry relative=\"1\" as=\"geometry\"/&gt;\n                &lt;/mxCell&gt;\n                &lt;mxCell id=\"Q0vGUsLp9HMjobRbkaUK-7\" value=\"MPICH\" style=\"rounded=0;whiteSpace=wrap;html=1;autosize=1;\" parent=\"1\" vertex=\"1\"&gt;\n                    &lt;mxGeometry x=\"115\" y=\"420\" width=\"60\" height=\"30\" as=\"geometry\"/&gt;\n                &lt;/mxCell&gt;\n                &lt;mxCell id=\"Q0vGUsLp9HMjobRbkaUK-9\" value=\"\" style=\"endArrow=classic;html=1;rounded=0;\" parent=\"1\" source=\"Q0vGUsLp9HMjobRbkaUK-7\" target=\"Q0vGUsLp9HMjobRbkaUK-6\" edge=\"1\"&gt;\n                    &lt;mxGeometry width=\"50\" height=\"50\" relative=\"1\" as=\"geometry\"&gt;\n                        &lt;mxPoint x=\"150\" y=\"600\" as=\"sourcePoint\"/&gt;\n                        &lt;mxPoint x=\"200\" y=\"550\" as=\"targetPoint\"/&gt;\n                    &lt;/mxGeometry&gt;\n                &lt;/mxCell&gt;\n                &lt;mxCell id=\"Q0vGUsLp9HMjobRbkaUK-10\" value=\"MVAPICH\" style=\"rounded=0;whiteSpace=wrap;html=1;autosize=1;\" parent=\"1\" vertex=\"1\"&gt;\n                    &lt;mxGeometry x=\"195\" y=\"430\" width=\"80\" height=\"30\" as=\"geometry\"/&gt;\n                &lt;/mxCell&gt;\n                &lt;mxCell id=\"Q0vGUsLp9HMjobRbkaUK-12\" value=\"Platform MPI\" style=\"rounded=0;whiteSpace=wrap;html=1;autosize=1;fillColor=#f5f5f5;fontColor=#333333;strokeColor=#666666;\" parent=\"1\" vertex=\"1\"&gt;\n                    &lt;mxGeometry x=\"115\" y=\"470\" width=\"90\" height=\"30\" as=\"geometry\"/&gt;\n                &lt;/mxCell&gt;\n                &lt;mxCell id=\"Q0vGUsLp9HMjobRbkaUK-13\" value=\"PGAS (Partitioned Global Address Space)\" style=\"rounded=0;whiteSpace=wrap;html=1;verticalAlign=top;\" parent=\"1\" vertex=\"1\"&gt;\n                    &lt;mxGeometry x=\"310\" y=\"340\" width=\"330\" height=\"170\" as=\"geometry\"/&gt;\n                &lt;/mxCell&gt;\n                &lt;mxCell id=\"Q0vGUsLp9HMjobRbkaUK-14\" value=\"SHMEM (Shared Memory)\" style=\"rounded=0;whiteSpace=wrap;html=1;verticalAlign=top;\" parent=\"1\" vertex=\"1\"&gt;\n                    &lt;mxGeometry x=\"320\" y=\"370\" width=\"210\" height=\"135\" as=\"geometry\"/&gt;\n                &lt;/mxCell&gt;\n                &lt;mxCell id=\"Q0vGUsLp9HMjobRbkaUK-16\" value=\"OpenSHMEM\" style=\"rounded=0;whiteSpace=wrap;html=1;autosize=1;\" parent=\"1\" vertex=\"1\"&gt;\n                    &lt;mxGeometry x=\"330\" y=\"400\" width=\"100\" height=\"30\" as=\"geometry\"/&gt;\n                &lt;/mxCell&gt;\n                &lt;mxCell id=\"Q0vGUsLp9HMjobRbkaUK-17\" value=\"&amp;lt;div&amp;gt;Communication&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;Framework&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;\" style=\"text;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontStyle=1;fontSize=24;\" parent=\"1\" vertex=\"1\"&gt;\n                    &lt;mxGeometry x=\"-100\" y=\"561\" width=\"60\" height=\"30\" as=\"geometry\"/&gt;\n                &lt;/mxCell&gt;\n                &lt;mxCell id=\"Q0vGUsLp9HMjobRbkaUK-22\" value=\"UCX\" style=\"rounded=0;whiteSpace=wrap;html=1;verticalAlign=top;\" parent=\"1\" vertex=\"1\"&gt;\n                    &lt;mxGeometry x=\"100\" y=\"526\" width=\"130\" height=\"100\" as=\"geometry\"/&gt;\n                &lt;/mxCell&gt;\n                &lt;mxCell id=\"Q0vGUsLp9HMjobRbkaUK-23\" value=\"UCP (Protocol)\" style=\"rounded=0;whiteSpace=wrap;html=1;autosize=1;\" parent=\"1\" vertex=\"1\"&gt;\n                    &lt;mxGeometry x=\"115\" y=\"561\" width=\"100\" height=\"30\" as=\"geometry\"/&gt;\n                &lt;/mxCell&gt;\n                &lt;mxCell id=\"Q0vGUsLp9HMjobRbkaUK-24\" value=\"UCT (Transport)\" style=\"rounded=0;whiteSpace=wrap;html=1;autosize=1;\" parent=\"1\" vertex=\"1\"&gt;\n                    &lt;mxGeometry x=\"110\" y=\"591\" width=\"110\" height=\"30\" as=\"geometry\"/&gt;\n                &lt;/mxCell&gt;\n                &lt;mxCell id=\"Q0vGUsLp9HMjobRbkaUK-25\" value=\"libfabric\" style=\"rounded=0;whiteSpace=wrap;html=1;verticalAlign=top;\" parent=\"1\" vertex=\"1\"&gt;\n                    &lt;mxGeometry x=\"244\" y=\"526\" width=\"130\" height=\"100\" as=\"geometry\"/&gt;\n                &lt;/mxCell&gt;\n                &lt;mxCell id=\"Q0vGUsLp9HMjobRbkaUK-26\" value=\"libfabric core (API)\" style=\"rounded=0;whiteSpace=wrap;html=1;autosize=1;\" parent=\"1\" vertex=\"1\"&gt;\n                    &lt;mxGeometry x=\"249\" y=\"561\" width=\"120\" height=\"30\" as=\"geometry\"/&gt;\n                &lt;/mxCell&gt;\n                &lt;mxCell id=\"Q0vGUsLp9HMjobRbkaUK-27\" value=\"Provider\" style=\"rounded=0;whiteSpace=wrap;html=1;autosize=1;\" parent=\"1\" vertex=\"1\"&gt;\n                    &lt;mxGeometry x=\"274\" y=\"591\" width=\"70\" height=\"30\" as=\"geometry\"/&gt;\n                &lt;/mxCell&gt;\n                &lt;mxCell id=\"Q0vGUsLp9HMjobRbkaUK-28\" value=\"&amp;lt;div&amp;gt;RDMA&amp;amp;nbsp;&amp;lt;span style=&amp;quot;background-color: transparent;&amp;quot;&amp;gt;API&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;\" style=\"text;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontStyle=1;fontSize=24;\" parent=\"1\" vertex=\"1\"&gt;\n                    &lt;mxGeometry x=\"-100\" y=\"684.5\" width=\"170\" height=\"30\" as=\"geometry\"/&gt;\n                &lt;/mxCell&gt;\n                &lt;mxCell id=\"Q0vGUsLp9HMjobRbkaUK-30\" value=\"libibverbs\" style=\"rounded=0;whiteSpace=wrap;html=1;autosize=1;\" parent=\"1\" vertex=\"1\"&gt;\n                    &lt;mxGeometry x=\"116\" y=\"684\" width=\"70\" height=\"30\" as=\"geometry\"/&gt;\n                &lt;/mxCell&gt;\n                &lt;mxCell id=\"Q0vGUsLp9HMjobRbkaUK-31\" value=\"librdmacm\" style=\"rounded=0;whiteSpace=wrap;html=1;autosize=1;\" parent=\"1\" vertex=\"1\"&gt;\n                    &lt;mxGeometry x=\"269\" y=\"679.5\" width=\"80\" height=\"30\" as=\"geometry\"/&gt;\n                &lt;/mxCell&gt;\n                &lt;mxCell id=\"Q0vGUsLp9HMjobRbkaUK-32\" value=\"(U)DAPL\" style=\"rounded=0;whiteSpace=wrap;html=1;verticalAlign=top;fillColor=#f5f5f5;fontColor=#333333;strokeColor=#666666;\" parent=\"1\" vertex=\"1\"&gt;\n                    &lt;mxGeometry x=\"382\" y=\"526\" width=\"130\" height=\"100\" as=\"geometry\"/&gt;\n                &lt;/mxCell&gt;\n                &lt;mxCell id=\"Q0vGUsLp9HMjobRbkaUK-33\" value=\"API\" style=\"rounded=0;whiteSpace=wrap;html=1;autosize=1;fillColor=#f5f5f5;fontColor=#333333;strokeColor=#666666;\" parent=\"1\" vertex=\"1\"&gt;\n                    &lt;mxGeometry x=\"427\" y=\"561\" width=\"40\" height=\"30\" as=\"geometry\"/&gt;\n                &lt;/mxCell&gt;\n                &lt;mxCell id=\"Q0vGUsLp9HMjobRbkaUK-34\" value=\"Provider\" style=\"rounded=0;whiteSpace=wrap;html=1;autosize=1;fillColor=#f5f5f5;fontColor=#333333;strokeColor=#666666;\" parent=\"1\" vertex=\"1\"&gt;\n                    &lt;mxGeometry x=\"412\" y=\"591\" width=\"70\" height=\"30\" as=\"geometry\"/&gt;\n                &lt;/mxCell&gt;\n                &lt;mxCell id=\"Q0vGUsLp9HMjobRbkaUK-35\" value=\"NVSHMEM\" style=\"rounded=0;whiteSpace=wrap;html=1;autosize=1;\" parent=\"1\" vertex=\"1\"&gt;\n                    &lt;mxGeometry x=\"330\" y=\"440\" width=\"80\" height=\"30\" as=\"geometry\"/&gt;\n                &lt;/mxCell&gt;\n                &lt;mxCell id=\"Q0vGUsLp9HMjobRbkaUK-36\" value=\"AI Framework\" style=\"rounded=0;whiteSpace=wrap;html=1;verticalAlign=top;\" parent=\"1\" vertex=\"1\"&gt;\n                    &lt;mxGeometry x=\"660\" y=\"340\" width=\"160\" height=\"170\" as=\"geometry\"/&gt;\n                &lt;/mxCell&gt;\n                &lt;mxCell id=\"Q0vGUsLp9HMjobRbkaUK-37\" value=\"torch.distributed\" style=\"rounded=0;whiteSpace=wrap;html=1;autosize=1;\" parent=\"1\" vertex=\"1\"&gt;\n                    &lt;mxGeometry x=\"675\" y=\"390\" width=\"110\" height=\"30\" as=\"geometry\"/&gt;\n                &lt;/mxCell&gt;\n                &lt;mxCell id=\"Q0vGUsLp9HMjobRbkaUK-38\" value=\"TensorFlow\" style=\"rounded=0;whiteSpace=wrap;html=1;autosize=1;\" parent=\"1\" vertex=\"1\"&gt;\n                    &lt;mxGeometry x=\"690\" y=\"430\" width=\"80\" height=\"30\" as=\"geometry\"/&gt;\n                &lt;/mxCell&gt;\n                &lt;mxCell id=\"Q0vGUsLp9HMjobRbkaUK-40\" value=\"*CCL\" style=\"rounded=0;whiteSpace=wrap;html=1;verticalAlign=top;\" parent=\"1\" vertex=\"1\"&gt;\n                    &lt;mxGeometry x=\"526\" y=\"526\" width=\"240\" height=\"100\" as=\"geometry\"/&gt;\n                &lt;/mxCell&gt;\n                &lt;mxCell id=\"Q0vGUsLp9HMjobRbkaUK-41\" value=\"NCCL\" style=\"rounded=0;whiteSpace=wrap;html=1;autosize=1;\" parent=\"1\" vertex=\"1\"&gt;\n                    &lt;mxGeometry x=\"536\" y=\"561\" width=\"60\" height=\"30\" as=\"geometry\"/&gt;\n                &lt;/mxCell&gt;\n                &lt;mxCell id=\"Q0vGUsLp9HMjobRbkaUK-42\" value=\"HCCL\" style=\"rounded=0;whiteSpace=wrap;html=1;autosize=1;\" parent=\"1\" vertex=\"1\"&gt;\n                    &lt;mxGeometry x=\"601\" y=\"561\" width=\"60\" height=\"30\" as=\"geometry\"/&gt;\n                &lt;/mxCell&gt;\n                &lt;mxCell id=\"Q0vGUsLp9HMjobRbkaUK-43\" value=\"TCCL\" style=\"rounded=0;whiteSpace=wrap;html=1;autosize=1;\" parent=\"1\" vertex=\"1\"&gt;\n                    &lt;mxGeometry x=\"666\" y=\"561\" width=\"50\" height=\"30\" as=\"geometry\"/&gt;\n                &lt;/mxCell&gt;\n                &lt;mxCell id=\"Q0vGUsLp9HMjobRbkaUK-44\" value=\"...\" style=\"rounded=0;whiteSpace=wrap;html=1;autosize=1;\" parent=\"1\" vertex=\"1\"&gt;\n                    &lt;mxGeometry x=\"722\" y=\"561\" width=\"30\" height=\"30\" as=\"geometry\"/&gt;\n                &lt;/mxCell&gt;\n                &lt;mxCell id=\"Q0vGUsLp9HMjobRbkaUK-45\" value=\"IntelSHMEM\" style=\"rounded=0;whiteSpace=wrap;html=1;autosize=1;\" parent=\"1\" vertex=\"1\"&gt;\n                    &lt;mxGeometry x=\"414\" y=\"440\" width=\"90\" height=\"30\" as=\"geometry\"/&gt;\n                &lt;/mxCell&gt;\n                &lt;mxCell id=\"Q0vGUsLp9HMjobRbkaUK-46\" value=\"mlx5dv\" style=\"rounded=0;whiteSpace=wrap;html=1;autosize=1;\" parent=\"1\" vertex=\"1\"&gt;\n                    &lt;mxGeometry x=\"205\" y=\"714\" width=\"60\" height=\"30\" as=\"geometry\"/&gt;\n                &lt;/mxCell&gt;\n                &lt;mxCell id=\"Q0vGUsLp9HMjobRbkaUK-50\" value=\"UPC\" style=\"rounded=0;whiteSpace=wrap;html=1;autosize=1;\" parent=\"1\" vertex=\"1\"&gt;\n                    &lt;mxGeometry x=\"550\" y=\"370\" width=\"50\" height=\"30\" as=\"geometry\"/&gt;\n                &lt;/mxCell&gt;\n                &lt;mxCell id=\"2\" value=\"Deprecated\" style=\"rounded=0;whiteSpace=wrap;html=1;verticalAlign=middle;fillColor=#f5f5f5;fontColor=#333333;strokeColor=#666666;autosize=0;labelPosition=right;verticalLabelPosition=middle;align=left;\" parent=\"1\" vertex=\"1\"&gt;\n                    &lt;mxGeometry x=\"-100\" y=\"291\" width=\"20\" height=\"20\" as=\"geometry\"/&gt;\n                &lt;/mxCell&gt;\n                &lt;mxCell id=\"3\" value=\"The World of High Performance Network (HPN)\" style=\"text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontStyle=1;fontSize=36;\" parent=\"1\" vertex=\"1\"&gt;\n                    &lt;mxGeometry x=\"-77.25\" y=\"166\" width=\"860.5\" height=\"30\" as=\"geometry\"/&gt;\n                &lt;/mxCell&gt;\n                &lt;mxCell id=\"7\" value=\"OFED\" style=\"rounded=0;whiteSpace=wrap;html=1;verticalAlign=top;dashed=1;dashPattern=8 8;\" parent=\"1\" vertex=\"1\"&gt;\n                    &lt;mxGeometry x=\"390\" y=\"649\" width=\"100\" height=\"101\" as=\"geometry\"/&gt;\n                &lt;/mxCell&gt;\n                &lt;mxCell id=\"13\" style=\"edgeStyle=none;html=1;\" parent=\"1\" source=\"8\" target=\"9\" edge=\"1\"&gt;\n                    &lt;mxGeometry relative=\"1\" as=\"geometry\"/&gt;\n                &lt;/mxCell&gt;\n                &lt;mxCell id=\"8\" value=\"MLNX_OFED\" style=\"rounded=0;whiteSpace=wrap;html=1;verticalAlign=top;dashed=1;dashPattern=8 8;\" parent=\"1\" vertex=\"1\"&gt;\n                    &lt;mxGeometry x=\"507\" y=\"648.5\" width=\"100\" height=\"101\" as=\"geometry\"/&gt;\n                &lt;/mxCell&gt;\n                &lt;mxCell id=\"9\" value=\"DOCA\" style=\"rounded=0;whiteSpace=wrap;html=1;verticalAlign=top;dashed=1;dashPattern=8 8;\" parent=\"1\" vertex=\"1\"&gt;\n                    &lt;mxGeometry x=\"622\" y=\"648\" width=\"84\" height=\"101.5\" as=\"geometry\"/&gt;\n                &lt;/mxCell&gt;\n                &lt;mxCell id=\"14\" value=\"Creator: bowling233\" style=\"text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;\" parent=\"1\" vertex=\"1\"&gt;\n                    &lt;mxGeometry x=\"253\" y=\"206\" width=\"200\" height=\"30\" as=\"geometry\"/&gt;\n                &lt;/mxCell&gt;\n                &lt;mxCell id=\"15\" value=\"Inspired by: UCX and MVAPICH-2X Architecture Diagram\" style=\"text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;\" parent=\"1\" vertex=\"1\"&gt;\n                    &lt;mxGeometry x=\"163\" y=\"231\" width=\"380\" height=\"30\" as=\"geometry\"/&gt;\n                &lt;/mxCell&gt;\n                &lt;mxCell id=\"16\" value=\"Kernel Driver\" style=\"text;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontStyle=1;fontSize=24;\" parent=\"1\" vertex=\"1\"&gt;\n                    &lt;mxGeometry x=\"-99.75\" y=\"862\" width=\"170\" height=\"30\" as=\"geometry\"/&gt;\n                &lt;/mxCell&gt;\n                &lt;mxCell id=\"17\" value=\"mthca&amp;amp;nbsp;\" style=\"rounded=0;whiteSpace=wrap;html=1;autosize=0;horizontal=0;\" parent=\"1\" vertex=\"1\"&gt;\n                    &lt;mxGeometry x=\"276\" y=\"922\" width=\"25\" height=\"46\" as=\"geometry\"/&gt;\n                &lt;/mxCell&gt;\n                &lt;mxCell id=\"31\" value=\"sw\" style=\"rounded=0;whiteSpace=wrap;html=1;verticalAlign=middle;dashed=1;dashPattern=8 8;align=left;fontSize=24;\" parent=\"1\" vertex=\"1\"&gt;\n                    &lt;mxGeometry x=\"100\" y=\"832\" width=\"720\" height=\"60\" as=\"geometry\"/&gt;\n                &lt;/mxCell&gt;\n                &lt;mxCell id=\"33\" value=\"rxe\" style=\"rounded=0;whiteSpace=wrap;html=1;autosize=1;\" parent=\"1\" vertex=\"1\"&gt;\n                    &lt;mxGeometry x=\"206\" y=\"847\" width=\"40\" height=\"30\" as=\"geometry\"/&gt;\n                &lt;/mxCell&gt;\n                &lt;mxCell id=\"34\" value=\"rdmavt\" style=\"rounded=0;whiteSpace=wrap;html=1;autosize=1;\" parent=\"1\" vertex=\"1\"&gt;\n                    &lt;mxGeometry x=\"332\" y=\"847\" width=\"60\" height=\"30\" as=\"geometry\"/&gt;\n                &lt;/mxCell&gt;\n                &lt;mxCell id=\"35\" value=\"siw\" style=\"rounded=0;whiteSpace=wrap;html=1;autosize=1;\" parent=\"1\" vertex=\"1\"&gt;\n                    &lt;mxGeometry x=\"276\" y=\"847\" width=\"40\" height=\"30\" as=\"geometry\"/&gt;\n                &lt;/mxCell&gt;\n                &lt;mxCell id=\"42\" value=\"ulp\" style=\"rounded=0;whiteSpace=wrap;html=1;verticalAlign=middle;dashed=1;dashPattern=8 8;align=left;fontSize=24;\" parent=\"1\" vertex=\"1\"&gt;\n                    &lt;mxGeometry x=\"100\" y=\"762\" width=\"720\" height=\"60\" as=\"geometry\"/&gt;\n                &lt;/mxCell&gt;\n                &lt;mxCell id=\"43\" value=\"ipoib\" style=\"rounded=0;whiteSpace=wrap;html=1;autosize=1;\" parent=\"1\" vertex=\"1\"&gt;\n                    &lt;mxGeometry x=\"201\" y=\"777\" width=\"50\" height=\"30\" as=\"geometry\"/&gt;\n                &lt;/mxCell&gt;\n                &lt;mxCell id=\"44\" value=\"linux/drivers/infiniband\" style=\"text;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;\" parent=\"1\" vertex=\"1\"&gt;\n                    &lt;mxGeometry x=\"-99.75\" y=\"892\" width=\"129.75\" height=\"30\" as=\"geometry\"/&gt;\n                &lt;/mxCell&gt;\n                &lt;mxCell id=\"45\" value=\"DPDK\" style=\"rounded=0;whiteSpace=wrap;html=1;verticalAlign=top;\" parent=\"1\" vertex=\"1\"&gt;\n                    &lt;mxGeometry x=\"780\" y=\"526\" width=\"40\" height=\"100\" as=\"geometry\"/&gt;\n                &lt;/mxCell&gt;\n                &lt;mxCell id=\"46\" value=\"*_OFED\" style=\"rounded=0;whiteSpace=wrap;html=1;verticalAlign=top;dashed=1;dashPattern=8 8;\" vertex=\"1\" parent=\"1\"&gt;\n                    &lt;mxGeometry x=\"720\" y=\"649\" width=\"100\" height=\"101\" as=\"geometry\"/&gt;\n                &lt;/mxCell&gt;\n                &lt;mxCell id=\"48\" value=\"RoCE\" style=\"rounded=0;whiteSpace=wrap;html=1;verticalAlign=middle;align=left;\" vertex=\"1\" parent=\"1\"&gt;\n                    &lt;mxGeometry x=\"152\" y=\"972\" width=\"618\" height=\"30\" as=\"geometry\"/&gt;\n                &lt;/mxCell&gt;\n                &lt;mxCell id=\"49\" value=\"iWARP\" style=\"rounded=0;whiteSpace=wrap;html=1;verticalAlign=middle;align=left;\" vertex=\"1\" parent=\"1\"&gt;\n                    &lt;mxGeometry x=\"152\" y=\"1012\" width=\"618\" height=\"30\" as=\"geometry\"/&gt;\n                &lt;/mxCell&gt;\n                &lt;mxCell id=\"23\" value=\"irdma\" style=\"rounded=0;whiteSpace=wrap;html=1;autosize=0;horizontal=0;\" parent=\"1\" vertex=\"1\"&gt;\n                    &lt;mxGeometry x=\"448\" y=\"975\" width=\"25\" height=\"66\" as=\"geometry\"/&gt;\n                &lt;/mxCell&gt;\n                &lt;mxCell id=\"18\" value=\"mlx5\" style=\"rounded=0;whiteSpace=wrap;html=1;autosize=0;horizontal=0;\" parent=\"1\" vertex=\"1\"&gt;\n                    &lt;mxGeometry x=\"345\" y=\"934\" width=\"25\" height=\"66\" as=\"geometry\"/&gt;\n                &lt;/mxCell&gt;\n                &lt;mxCell id=\"19\" value=\"mlx4\" style=\"rounded=0;whiteSpace=wrap;html=1;autosize=0;horizontal=0;\" parent=\"1\" vertex=\"1\"&gt;\n                    &lt;mxGeometry x=\"310\" y=\"934\" width=\"25\" height=\"66\" as=\"geometry\"/&gt;\n                &lt;/mxCell&gt;\n                &lt;mxCell id=\"24\" value=\"hns\" style=\"rounded=0;whiteSpace=wrap;html=1;autosize=0;horizontal=0;\" parent=\"1\" vertex=\"1\"&gt;\n                    &lt;mxGeometry x=\"413\" y=\"966\" width=\"25\" height=\"41\" as=\"geometry\"/&gt;\n                &lt;/mxCell&gt;\n                &lt;mxCell id=\"26\" value=\"cxgb3\" style=\"rounded=0;whiteSpace=wrap;html=1;autosize=0;horizontal=0;\" parent=\"1\" vertex=\"1\"&gt;\n                    &lt;mxGeometry x=\"487\" y=\"1000\" width=\"25\" height=\"52\" as=\"geometry\"/&gt;\n                &lt;/mxCell&gt;\n                &lt;mxCell id=\"51\" value=\"Cloud\" style=\"rounded=0;whiteSpace=wrap;html=1;verticalAlign=middle;align=left;\" vertex=\"1\" parent=\"1\"&gt;\n                    &lt;mxGeometry x=\"152\" y=\"1052\" width=\"618\" height=\"30\" as=\"geometry\"/&gt;\n                &lt;/mxCell&gt;\n                &lt;mxCell id=\"22\" value=\"erdma\" style=\"rounded=0;whiteSpace=wrap;html=1;autosize=0;horizontal=0;\" parent=\"1\" vertex=\"1\"&gt;\n                    &lt;mxGeometry x=\"215\" y=\"1010\" width=\"25\" height=\"72\" as=\"geometry\"/&gt;\n                &lt;/mxCell&gt;\n                &lt;mxCell id=\"52\" value=\"efa\" style=\"rounded=0;whiteSpace=wrap;html=1;autosize=0;horizontal=0;\" vertex=\"1\" parent=\"1\"&gt;\n                    &lt;mxGeometry x=\"260\" y=\"1042\" width=\"25\" height=\"40\" as=\"geometry\"/&gt;\n                &lt;/mxCell&gt;\n            &lt;/root&gt;\n        &lt;/mxGraphModel&gt;\n    &lt;/diagram&gt;\n&lt;/mxfile&gt;"}' style="max-width:100%;border:1px solid transparent;"></div></a></p>
<h2 id="rdma">RDMA<a class="headerlink" href="#rdma" title="Permanent link">¶</a></h2>
<p>学习 HPN 应当从 RDMA 基本概念开始。目前，RDMA 入门的最佳中文材料是 Savir 所作的 <a href="https://www.zhihu.com/column/c_1231181516811390976">RDMA 杂谈 - 知乎</a>，请读者自行阅读，本篇笔记不会再讲解其中的知识。其中基本概念篇（第 1-12）必读，后面的内容可根据工作需要具体选择，因为 RDMA 具体实现之间有不少差异。</p>
<p>读者应当了解：</p>
<ul>
<li>基本元素：<ul>
<li>Send/Receive Queue</li>
<li>Work Queue Element</li>
<li>Queue Pair：存放 WQE 的一块空间<ul>
<li>特殊 QP：<ul>
<li>0：子网管理 Subnet Management Interface（仅 InfiniBand）</li>
<li>1：通用服务接口 General Service Interface，包括 CM</li>
</ul>
</li>
<li>状态：RST、INIT、RTR、RTS、SQD、SQEr、ERR</li>
</ul>
</li>
<li>Queue Pair Context：S/RQ 的地址、大小、编号等信息<ul>
<li>QPN 24b 节点唯一，GID 128b 网络唯一</li>
</ul>
</li>
<li>Completion Queue<ul>
<li>可关联多个 S/RQ</li>
<li>同一 WQ 的 CQE 保序；SRQ 和 RD 下的 RQ 不保序</li>
</ul>
</li>
<li>Completion Queue Element：<ul>
<li>包含 WQE 编号</li>
<li>错误类型：Immediate（立即返回上报）/Completion（CQE 上报）/Asynchronous（中断上报）</li>
<li>通知方式：Poll、Notification</li>
</ul>
</li>
</ul>
</li>
<li>操作类型：Send-Receive、Write、Read、Atomic</li>
<li>服务类型：Reliable/Unreliable、Connection/Datagram<ul>
<li>UD：QP 间无连接，WQE 中填 Address；为了安全，此时有 QKey，请求中也带上<ul>
<li>最高位为 <code>1</code> 的 QKey 是特权 QKey，只有内核能用</li>
</ul>
</li>
<li>RD：End-to-End Context</li>
</ul>
</li>
<li>资源结构：<ul>
<li>Memory Region：<ul>
<li>作用：VA/PA/IOVA 转换、R/LKey 访问权限控制、Pin 页面</li>
<li>权限：Remote/Local Read/Write/Atomic</li>
<li>L/RKey 组成：24b index 索引转换表 + 8b key 校验</li>
<li>要使 RKey 失效，只能注销重注册</li>
<li>Memory Window：动态绑定到 MR，灵活控制权限，无需内核态</li>
</ul>
</li>
<li>Scatter Gather Element/List：<ul>
<li>内容：地址、长度、LKey</li>
</ul>
</li>
<li>Protection Domain：安全性，阻止 AH、QP 和 MR 等资源的跨 PD 互访</li>
<li>Address Handle：地址指 GID、端口号和 MAC 地址等，UD 通过 AH 索引地址信息</li>
<li>Queue Pair、Completion Queue</li>
</ul>
</li>
<li>网络结构：<ul>
<li>Global Routing Header：<ul>
<li>RoCE 网络必须</li>
</ul>
</li>
</ul>
</li>
<li>高级话题：<ul>
<li>SRQ：<ul>
<li>RC/UC/UD 接收方必须预先下发足够多的 WQE，造成大量 RQ 浪费，通过共享节省内存</li>
<li>所属的 PD 可以与关联的 QP 不同</li>
<li>状态：只有错误和非错误，错误了只能销毁</li>
</ul>
</li>
<li>Connection Management Protocol：<ul>
<li>MAnagement Datagram：基于 UD 实现，向上支持 GS 和 SM；使用 QP1 和 QKey <code>0x8001_0000</code></li>
</ul>
</li>
</ul>
</li>
<li>
<p>建链：<a href="https://www.rdmamojo.com/2014/01/18/connecting-queue-pairs/">Connecting Queue Pairs « RDMAmojo</a></p>
<table>
<thead>
<tr>
<th>传输类型</th>
<th>需要交换的信息</th>
</tr>
</thead>
<tbody>
<tr>
<td>RC Send</td>
<td>GID, QPN</td>
</tr>
<tr>
<td>RC Write/Read</td>
<td>GID, QPN, VA, RKey</td>
</tr>
<tr>
<td>UD Send</td>
<td>GID, QPN, QKey</td>
</tr>
</tbody>
</table>
</li>
</ul>
<p>作者最后一次更新是在 2023 年，尚有一些内容鸽了没有介绍。接下来本章就一些高级话题进行补充。</p>
<p>专栏中只作了概念介绍。如果希望将习得的概念应用到编程中，可以阅读下面的两份材料入门 IB Verbs。</p>
<ul>
<li>简单：<a href="https://www.doc.ic.ac.uk/~jgiceva/teaching/ssc18-rdma.pdf">RDMA Tutorial - LSDS</a></li>
<li>详细：<a href="https://www.csm.ornl.gov/workshops/openshmem2014/documents/presentations_and_tutorials/Tutorials/Verbs%20programming%20tutorial-final.pdf">Verbs programming tutorial</a></li>
</ul>
<h3 id="extended-reliable-connection-xrc">eXtended Reliable Connection (XRC)<a class="headerlink" href="#extended-reliable-connection-xrc" title="Permanent link">¶</a></h3>
<div class="admonition quote">
<p class="admonition-title">Quote</p>
<ul>
<li>(2007) <a href="https://downloads.openfabrics.org/Media/SC07/2007_SC_Nov_XRC.pdf">Microsoft PowerPoint - XRC</a></li>
<li>(2008) <a href="https://lists.openfabrics.org/pipermail/general/2008-June/051889.html">[ofa-general] [PATCH 1/11] libibverbs: XRC base implementation</a></li>
</ul>
</div>
<div class="admonition warning">
<p class="admonition-title">XRC 是 libfabric 独有的功能</p>
</div>
<p>还记得 SRQ 吗？它通过共享 RQ 的方式大量节省了接收端的内存占用。假设有 <span class="arithmatex">\(n\)</span> 个节点，每个节点有 <span class="arithmatex">\(c\)</span> 个核，每个核上都跑一个通信进程：</p>
<p>SRQ 将 QP 数从 <span class="arithmatex">\(n \times c^2\)</span> 降低到 <span class="arithmatex">\(n \times c\)</span>。</p>
<p>XRC 尝试在此之上继续降低内存占用，这次通过<strong>减少连接数</strong>的方式实现。</p>
<p>XRC 的想法类似于 RDMA RD</p>
<h3 id="_2">其他问题<a class="headerlink" href="#_2" title="Permanent link">¶</a></h3>
<ul>
<li>为什么 SRQ 和 RD 下的 RQ 不保序？</li>
</ul>
<h2 id="_3">软件栈<a class="headerlink" href="#_3" title="Permanent link">¶</a></h2>
<p>阅读 <a href="https://www.rohitzambre.com/blog/2018/2/9/for-the-rdma-novice-libfabric-libibverbs-infiniband-ofed-mofed">For the RDMA novice: libfabric, libibverbs, InfiniBand, OFED, MOFED? — Rohit Zambre</a>，了解这些软件包的关系。</p>
<h3 id="_4">实用工具<a class="headerlink" href="#_4" title="Permanent link">¶</a></h3>
<h4 id="infiniband-diags">infiniband-diags<a class="headerlink" href="#infiniband-diags" title="Permanent link">¶</a></h4>
<p>提供了非常多的工具，见 <a href="https://github.com/linux-rdma/rdma-core/blob/master/infiniband-diags/man/infiniband-diags.8.in.rst">infiniband-diags(8)</a>。在 Debian 上，它们位于 <code>/usr/sbin</code> 中。</p>
<p>这里记录常用的一些：</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-0-1"><a href="#__codelineno-0-1" id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="c1"># 查询</span>
</span><span id="__span-0-2"><a href="#__codelineno-0-2" id="__codelineno-0-2" name="__codelineno-0-2"></a>ibstat
</span><span id="__span-0-3"><a href="#__codelineno-0-3" id="__codelineno-0-3" name="__codelineno-0-3"></a>ibstatus
</span><span id="__span-0-4"><a href="#__codelineno-0-4" id="__codelineno-0-4" name="__codelineno-0-4"></a>ibaddr
</span><span id="__span-0-5"><a href="#__codelineno-0-5" id="__codelineno-0-5" name="__codelineno-0-5"></a>ibnodes
</span><span id="__span-0-6"><a href="#__codelineno-0-6" id="__codelineno-0-6" name="__codelineno-0-6"></a>ibhosts
</span><span id="__span-0-7"><a href="#__codelineno-0-7" id="__codelineno-0-7" name="__codelineno-0-7"></a>ibrouters
</span><span id="__span-0-8"><a href="#__codelineno-0-8" id="__codelineno-0-8" name="__codelineno-0-8"></a>ibswitches
</span><span id="__span-0-9"><a href="#__codelineno-0-9" id="__codelineno-0-9" name="__codelineno-0-9"></a>iblinkinfo
</span><span id="__span-0-10"><a href="#__codelineno-0-10" id="__codelineno-0-10" name="__codelineno-0-10"></a>ibnetdiscover
</span><span id="__span-0-11"><a href="#__codelineno-0-11" id="__codelineno-0-11" name="__codelineno-0-11"></a><span class="c1"># 查询当前 IB 子网管理的位置</span>
</span><span id="__span-0-12"><a href="#__codelineno-0-12" id="__codelineno-0-12" name="__codelineno-0-12"></a>sminfo
</span><span id="__span-0-13"><a href="#__codelineno-0-13" id="__codelineno-0-13" name="__codelineno-0-13"></a><span class="c1"># 测试</span>
</span><span id="__span-0-14"><a href="#__codelineno-0-14" id="__codelineno-0-14" name="__codelineno-0-14"></a>ibping<span class="w"> </span><span class="c1"># 注意，需要在另一台机器上使用 ibping -S 作为 server，否则是 ping 不通的。</span>
</span><span id="__span-0-15"><a href="#__codelineno-0-15" id="__codelineno-0-15" name="__codelineno-0-15"></a>ibping<span class="w"> </span>-c<span class="w"> </span>&lt;count&gt;<span class="w"> </span>-L<span class="w"> </span>&lt;lid&gt;
</span><span id="__span-0-16"><a href="#__codelineno-0-16" id="__codelineno-0-16" name="__codelineno-0-16"></a>ibroute
</span><span id="__span-0-17"><a href="#__codelineno-0-17" id="__codelineno-0-17" name="__codelineno-0-17"></a>ibtracert
</span></code></pre></div>
<h4 id="opensm">OpenSM<a class="headerlink" href="#opensm" title="Permanent link">¶</a></h4>
<p>IB 管理交换机能够作为 Subnet Manager（SM）来管理 IB 网络。SM 负责发现和配置所有 InfiniBand 设备。</p>
<p>使用非网管 IB 交换机时，IB 网络中缺少 Subnet Manager（SM），此时所有 HCA 状态为 Initializing。可以在其中的一台主机上安装开源的 OpenSM：</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-1-1"><a href="#__codelineno-1-1" id="__codelineno-1-1" name="__codelineno-1-1"></a>sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>opensm
</span><span id="__span-1-2"><a href="#__codelineno-1-2" id="__codelineno-1-2" name="__codelineno-1-2"></a>sudo<span class="w"> </span>systemctl<span class="w"> </span><span class="nb">enable</span><span class="w"> </span>--now<span class="w"> </span>opensm
</span></code></pre></div>
<h4 id="mstflint">mstflint<a class="headerlink" href="#mstflint" title="Permanent link">¶</a></h4>
<div class="admonition quote">
<p class="admonition-title">Quote</p>
<ul>
<li><a href="https://github.com/Mellanox/mstflint"><span class="twemoji"><svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"></path></svg></span> Mellanox/mstflint: Mstflint - an open source version of MFT (Mellanox Firmware Tools)</a></li>
</ul>
</div>
<p><code>mstflint</code> 是 Mellanox Firmware Flash Interface 的缩写，用于管理 Mellanox 网卡的固件。诸如切换 RoCE 与 InfiniBand 模式、更新固件等比较底层的操作都可以通过这个工具完成。</p>
<p>下面以将端口模式从 ETH(2) 切换到 IB(1) 为例演示命令用法：</p>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-2-1"><a href="#__codelineno-2-1" id="__codelineno-2-1" name="__codelineno-2-1"></a>$<span class="w"> </span>mstconfig<span class="w"> </span>query
</span><span id="__span-2-2"><a href="#__codelineno-2-2" id="__codelineno-2-2" name="__codelineno-2-2"></a>$<span class="w"> </span>sudo<span class="w"> </span>mstconfig<span class="w"> </span>-d<span class="w"> </span>4b:00.0<span class="w"> </span><span class="nb">set</span><span class="w"> </span><span class="nv">LINK_TYPE_P1</span><span class="o">=</span><span class="m">1</span>
</span><span id="__span-2-3"><a href="#__codelineno-2-3" id="__codelineno-2-3" name="__codelineno-2-3"></a>
</span><span id="__span-2-4"><a href="#__codelineno-2-4" id="__codelineno-2-4" name="__codelineno-2-4"></a>Device<span class="w"> </span><span class="c1">#1:</span>
</span><span id="__span-2-5"><a href="#__codelineno-2-5" id="__codelineno-2-5" name="__codelineno-2-5"></a>----------
</span><span id="__span-2-6"><a href="#__codelineno-2-6" id="__codelineno-2-6" name="__codelineno-2-6"></a>
</span><span id="__span-2-7"><a href="#__codelineno-2-7" id="__codelineno-2-7" name="__codelineno-2-7"></a>Device<span class="w"> </span>type:<span class="w">        </span>ConnectX5
</span><span id="__span-2-8"><a href="#__codelineno-2-8" id="__codelineno-2-8" name="__codelineno-2-8"></a>Name:<span class="w">               </span>MCX555A-ECA_Ax_Bx
</span><span id="__span-2-9"><a href="#__codelineno-2-9" id="__codelineno-2-9" name="__codelineno-2-9"></a>Description:<span class="w">        </span>ConnectX-5<span class="w"> </span>VPI<span class="w"> </span>adapter<span class="w"> </span>card<span class="p">;</span><span class="w"> </span>EDR<span class="w"> </span>IB<span class="w"> </span><span class="o">(</span>100Gb/s<span class="o">)</span><span class="w"> </span>and<span class="w"> </span>100GbE<span class="p">;</span><span class="w"> </span>single-port<span class="w"> </span>QSFP28<span class="p">;</span><span class="w"> </span>PCIe3.0<span class="w"> </span>x16<span class="p">;</span><span class="w"> </span>tall<span class="w"> </span>bracket<span class="p">;</span><span class="w"> </span>ROHS<span class="w"> </span>R6
</span><span id="__span-2-10"><a href="#__codelineno-2-10" id="__codelineno-2-10" name="__codelineno-2-10"></a>Device:<span class="w">             </span>4b:00.0
</span><span id="__span-2-11"><a href="#__codelineno-2-11" id="__codelineno-2-11" name="__codelineno-2-11"></a>
</span><span id="__span-2-12"><a href="#__codelineno-2-12" id="__codelineno-2-12" name="__codelineno-2-12"></a>Configurations:<span class="w">                                     </span>Next<span class="w"> </span>Boot<span class="w">       </span>New
</span><span id="__span-2-13"><a href="#__codelineno-2-13" id="__codelineno-2-13" name="__codelineno-2-13"></a><span class="w">        </span>LINK_TYPE_P1<span class="w">                                </span>ETH<span class="o">(</span><span class="m">2</span><span class="o">)</span><span class="w">               </span>IB<span class="o">(</span><span class="m">1</span><span class="o">)</span>
</span><span id="__span-2-14"><a href="#__codelineno-2-14" id="__codelineno-2-14" name="__codelineno-2-14"></a>
</span><span id="__span-2-15"><a href="#__codelineno-2-15" id="__codelineno-2-15" name="__codelineno-2-15"></a><span class="w"> </span>Apply<span class="w"> </span>new<span class="w"> </span>Configuration?<span class="w"> </span><span class="o">(</span>y/n<span class="o">)</span><span class="w"> </span><span class="o">[</span>n<span class="o">]</span><span class="w"> </span>:<span class="w"> </span>y
</span><span id="__span-2-16"><a href="#__codelineno-2-16" id="__codelineno-2-16" name="__codelineno-2-16"></a>Applying...<span class="w"> </span>Done!
</span><span id="__span-2-17"><a href="#__codelineno-2-17" id="__codelineno-2-17" name="__codelineno-2-17"></a>-I-<span class="w"> </span>Please<span class="w"> </span>reboot<span class="w"> </span>machine<span class="w"> </span>to<span class="w"> </span>load<span class="w"> </span>new<span class="w"> </span>configurations.
</span><span id="__span-2-18"><a href="#__codelineno-2-18" id="__codelineno-2-18" name="__codelineno-2-18"></a>$<span class="w"> </span>mstfwreset<span class="w"> </span>-d<span class="w"> </span>4b:00.0<span class="w"> </span>-l3<span class="w"> </span>-y<span class="w"> </span>reset
</span></code></pre></div>
<p>其他命令见 mstflint 发布自带的手册。</p>
<details class="info">
<summary>老版本命令留档</summary>
<p>MLNX_OFED 包含了 mstflint，但一般版本较老，与新版 mstflint 命令不兼容。这里仅作为留档记录一下。</p>
<p>新版本相比老版本的变化：</p>
<ul>
<li>不需要执行 <code>mst start</code>，服务自动启动。</li>
<li>命令名称发生变化，比如 <code>mlxconfig</code> 变为 <code>mstconfig</code>。</li>
</ul>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-3-1"><a href="#__codelineno-3-1" id="__codelineno-3-1" name="__codelineno-3-1"></a><span class="c1"># 查看所有设备</span>
</span><span id="__span-3-2"><a href="#__codelineno-3-2" id="__codelineno-3-2" name="__codelineno-3-2"></a>mst<span class="w"> </span>status
</span><span id="__span-3-3"><a href="#__codelineno-3-3" id="__codelineno-3-3" name="__codelineno-3-3"></a><span class="c1"># 线缆</span>
</span><span id="__span-3-4"><a href="#__codelineno-3-4" id="__codelineno-3-4" name="__codelineno-3-4"></a>mst<span class="w"> </span>cable<span class="w"> </span>add<span class="w"> </span><span class="c1"># 扫描线缆，线缆一般不会自动被添加</span>
</span><span id="__span-3-5"><a href="#__codelineno-3-5" id="__codelineno-3-5" name="__codelineno-3-5"></a>mlxcables<span class="w"> </span>-d<span class="w"> </span>e3:00.0_cable_0<span class="w"> </span>-q
</span><span id="__span-3-6"><a href="#__codelineno-3-6" id="__codelineno-3-6" name="__codelineno-3-6"></a><span class="c1"># 链路</span>
</span><span id="__span-3-7"><a href="#__codelineno-3-7" id="__codelineno-3-7" name="__codelineno-3-7"></a>mlxlink
</span><span id="__span-3-8"><a href="#__codelineno-3-8" id="__codelineno-3-8" name="__codelineno-3-8"></a><span class="c1"># 配置</span>
</span><span id="__span-3-9"><a href="#__codelineno-3-9" id="__codelineno-3-9" name="__codelineno-3-9"></a>mlxconfig<span class="w"> </span>-d<span class="w"> </span>&lt;device&gt;<span class="w"> </span>query<span class="w"> </span><span class="c1"># 查询详细信息</span>
</span><span id="__span-3-10"><a href="#__codelineno-3-10" id="__codelineno-3-10" name="__codelineno-3-10"></a>Device<span class="w"> </span><span class="c1">#1:</span>
</span><span id="__span-3-11"><a href="#__codelineno-3-11" id="__codelineno-3-11" name="__codelineno-3-11"></a>----------
</span><span id="__span-3-12"><a href="#__codelineno-3-12" id="__codelineno-3-12" name="__codelineno-3-12"></a>Device<span class="w"> </span>type:<span class="w">    </span>ConnectX5
</span><span id="__span-3-13"><a href="#__codelineno-3-13" id="__codelineno-3-13" name="__codelineno-3-13"></a>Name:<span class="w">           </span>MCX555A-ECA_Ax_Bx
</span><span id="__span-3-14"><a href="#__codelineno-3-14" id="__codelineno-3-14" name="__codelineno-3-14"></a>Description:<span class="w">    </span>ConnectX-5<span class="w"> </span>VPI<span class="w"> </span>adapter<span class="w"> </span>card<span class="p">;</span><span class="w"> </span>EDR<span class="w"> </span>IB<span class="w"> </span><span class="o">(</span>100Gb/s<span class="o">)</span><span class="w"> </span>and<span class="w"> </span>100GbE<span class="p">;</span><span class="w"> </span>single-port<span class="w"> </span>QSFP28<span class="p">;</span><span class="w"> </span>PCIe3.0<span class="w"> </span>x16<span class="p">;</span><span class="w"> </span>tall<span class="w"> </span>bracket<span class="p">;</span><span class="w"> </span>ROHS<span class="w"> </span>R6
</span><span id="__span-3-15"><a href="#__codelineno-3-15" id="__codelineno-3-15" name="__codelineno-3-15"></a>Device:<span class="w">         </span><span class="m">31</span>:00.0
</span><span id="__span-3-16"><a href="#__codelineno-3-16" id="__codelineno-3-16" name="__codelineno-3-16"></a>Configurations:<span class="w">                                      </span>Next<span class="w"> </span>Boot
</span><span id="__span-3-17"><a href="#__codelineno-3-17" id="__codelineno-3-17" name="__codelineno-3-17"></a><span class="w">        </span>MEMIC_BAR_SIZE<span class="w">                              </span><span class="m">0</span>
</span><span id="__span-3-18"><a href="#__codelineno-3-18" id="__codelineno-3-18" name="__codelineno-3-18"></a><span class="w">        </span>MEMIC_SIZE_LIMIT<span class="w">                            </span>_256KB<span class="o">(</span><span class="m">1</span><span class="o">)</span>
</span><span id="__span-3-19"><a href="#__codelineno-3-19" id="__codelineno-3-19" name="__codelineno-3-19"></a><span class="w">        </span>HOST_CHAINING_MODE<span class="w">                          </span>DISABLED<span class="o">(</span><span class="m">0</span><span class="o">)</span>
</span><span id="__span-3-20"><a href="#__codelineno-3-20" id="__codelineno-3-20" name="__codelineno-3-20"></a><span class="w">        </span>HOST_CHAINING_CACHE_DISABLE<span class="w">                 </span>False<span class="o">(</span><span class="m">0</span><span class="o">)</span>
</span><span id="__span-3-21"><a href="#__codelineno-3-21" id="__codelineno-3-21" name="__codelineno-3-21"></a><span class="w">        </span>HOST_CHAINING_DESCRIPTORS<span class="w">                   </span>Array<span class="o">[</span><span class="m">0</span>..7<span class="o">]</span>
</span><span id="__span-3-22"><a href="#__codelineno-3-22" id="__codelineno-3-22" name="__codelineno-3-22"></a><span class="w">        </span>HOST_CHAINING_TOTAL_BUFFER_SIZE<span class="w">             </span>Array<span class="o">[</span><span class="m">0</span>..7<span class="o">]</span>
</span><span id="__span-3-23"><a href="#__codelineno-3-23" id="__codelineno-3-23" name="__codelineno-3-23"></a><span class="w">        </span>FLEX_PARSER_PROFILE_ENABLE<span class="w">                  </span><span class="m">0</span>
</span><span id="__span-3-24"><a href="#__codelineno-3-24" id="__codelineno-3-24" name="__codelineno-3-24"></a><span class="w">        </span>FLEX_IPV4_OVER_VXLAN_PORT<span class="w">                   </span><span class="m">0</span>
</span><span id="__span-3-25"><a href="#__codelineno-3-25" id="__codelineno-3-25" name="__codelineno-3-25"></a><span class="w">        </span>ROCE_NEXT_PROTOCOL<span class="w">                          </span><span class="m">254</span>
</span><span id="__span-3-26"><a href="#__codelineno-3-26" id="__codelineno-3-26" name="__codelineno-3-26"></a><span class="w">        </span>ESWITCH_HAIRPIN_DESCRIPTORS<span class="w">                 </span>Array<span class="o">[</span><span class="m">0</span>..7<span class="o">]</span>
</span><span id="__span-3-27"><a href="#__codelineno-3-27" id="__codelineno-3-27" name="__codelineno-3-27"></a><span class="w">        </span>ESWITCH_HAIRPIN_TOT_BUFFER_SIZE<span class="w">             </span>Array<span class="o">[</span><span class="m">0</span>..7<span class="o">]</span>
</span><span id="__span-3-28"><a href="#__codelineno-3-28" id="__codelineno-3-28" name="__codelineno-3-28"></a><span class="w">        </span>PF_BAR2_SIZE<span class="w">                                </span><span class="m">0</span>
</span></code></pre></div>
</details>
<h4 id="hca">HCA 卡<a class="headerlink" href="#hca" title="Permanent link">¶</a></h4>
<p>使用 <code>ibstat</code> 命令可以查看 HCA 卡的状态。只要能在这里看到 HCA 卡，就说明驱动已经加载。</p>
<p>端口的状态有以下几种：</p>
<table>
<thead>
<tr>
<th>State</th>
<th>Physical State</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>Down</td>
<td>Disabled</td>
<td>未连接线缆</td>
</tr>
<tr>
<td>Polling</td>
<td>Polling</td>
<td>如果持续处于该状态说明 IB 子网没有 SM</td>
</tr>
<tr>
<td>Active</td>
<td>LinkUp</td>
<td>连接正常</td>
</tr>
</tbody>
</table>
<h4 id="dhcp-for-ipoib">DHCP for IPoIB<a class="headerlink" href="#dhcp-for-ipoib" title="Permanent link">¶</a></h4>
<p>我们使用 dnsmasq 作为 DHCP 服务器。在 dnsmasq 官方示例中有这样一段：</p>
<div class="language-text highlight"><span class="filename">dnsmasq.conf</span><pre><span></span><code><span id="__span-4-1"><a href="#__codelineno-4-1" id="__codelineno-4-1" name="__codelineno-4-1"></a># Always give the InfiniBand interface with hardware address
</span><span id="__span-4-2"><a href="#__codelineno-4-2" id="__codelineno-4-2" name="__codelineno-4-2"></a># 80:00:00:48:fe:80:00:00:00:00:00:00:f4:52:14:03:00:28:05:81 the
</span><span id="__span-4-3"><a href="#__codelineno-4-3" id="__codelineno-4-3" name="__codelineno-4-3"></a># ip address 192.168.0.61. The client id is derived from the prefix
</span><span id="__span-4-4"><a href="#__codelineno-4-4" id="__codelineno-4-4" name="__codelineno-4-4"></a># ff:00:00:00:00:00:02:00:00:02:c9:00 and the last 8 pairs of
</span><span id="__span-4-5"><a href="#__codelineno-4-5" id="__codelineno-4-5" name="__codelineno-4-5"></a># hex digits of the hardware address.
</span><span id="__span-4-6"><a href="#__codelineno-4-6" id="__codelineno-4-6" name="__codelineno-4-6"></a># dhcp-host=id:ff:00:00:00:00:00:02:00:00:02:c9:00:f4:52:14:03:00:28:05:81,192.168.0.61
</span></code></pre></div>
<p>可能是因为 InfiniBand 迭代，现在已经不适用了。我们在 NVIDIA 的某份文档（忘掉是哪份了）中看到了这样的写法：</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-5-1"><a href="#__codelineno-5-1" id="__codelineno-5-1" name="__codelineno-5-1"></a>id:20 + 硬件地址后 8 对十六进制数字
</span></code></pre></div>
<p>这是可行的。</p>
<h4 id="benchmark">Benchmark<a class="headerlink" href="#benchmark" title="Permanent link">¶</a></h4>
<p><a href="https://github.com/linux-rdma/perftest"><code>perftest</code></a> 软件包由 <code>linux-rdma</code> 维护，用于测试 InfiniBand 性能，可用于 RoCE。</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-6-1"><a href="#__codelineno-6-1" id="__codelineno-6-1" name="__codelineno-6-1"></a><span class="c1"># 客户端</span>
</span><span id="__span-6-2"><a href="#__codelineno-6-2" id="__codelineno-6-2" name="__codelineno-6-2"></a>ib_write_lat<span class="w"> </span>--ib-dev<span class="o">=</span>mlx5_0<span class="w"> </span>--ib-port<span class="o">=</span><span class="m">1</span><span class="w"> </span>MAX01-ib<span class="w"> </span>-a<span class="w"> </span>-R
</span><span id="__span-6-3"><a href="#__codelineno-6-3" id="__codelineno-6-3" name="__codelineno-6-3"></a><span class="c1"># 服务端</span>
</span><span id="__span-6-4"><a href="#__codelineno-6-4" id="__codelineno-6-4" name="__codelineno-6-4"></a>ib_write_lat<span class="w"> </span>--ib-dev<span class="o">=</span>mlx5_0<span class="w"> </span>--ib-port<span class="o">=</span><span class="m">1</span><span class="w"> </span>-R<span class="w"> </span>-a
</span><span id="__span-6-5"><a href="#__codelineno-6-5" id="__codelineno-6-5" name="__codelineno-6-5"></a>
</span><span id="__span-6-6"><a href="#__codelineno-6-6" id="__codelineno-6-6" name="__codelineno-6-6"></a>ib_send_lat<span class="w">     </span>latency<span class="w"> </span><span class="nb">test</span><span class="w"> </span>with<span class="w"> </span>send<span class="w"> </span>transactions
</span><span id="__span-6-7"><a href="#__codelineno-6-7" id="__codelineno-6-7" name="__codelineno-6-7"></a>ib_send_bw<span class="w">      </span>bandwidth<span class="w"> </span><span class="nb">test</span><span class="w"> </span>with<span class="w"> </span>send<span class="w"> </span>transactions
</span><span id="__span-6-8"><a href="#__codelineno-6-8" id="__codelineno-6-8" name="__codelineno-6-8"></a>ib_write_lat<span class="w">    </span>latency<span class="w"> </span><span class="nb">test</span><span class="w"> </span>with<span class="w"> </span>RDMA<span class="w"> </span>write<span class="w"> </span>transactions
</span><span id="__span-6-9"><a href="#__codelineno-6-9" id="__codelineno-6-9" name="__codelineno-6-9"></a>ib_write_bw<span class="w">     </span>bandwidth<span class="w"> </span><span class="nb">test</span><span class="w"> </span>with<span class="w"> </span>RDMA<span class="w"> </span>write<span class="w"> </span>transactions
</span><span id="__span-6-10"><a href="#__codelineno-6-10" id="__codelineno-6-10" name="__codelineno-6-10"></a>ib_read_lat<span class="w">     </span>latency<span class="w"> </span><span class="nb">test</span><span class="w"> </span>with<span class="w"> </span>RDMA<span class="w"> </span><span class="nb">read</span><span class="w"> </span>transactions
</span><span id="__span-6-11"><a href="#__codelineno-6-11" id="__codelineno-6-11" name="__codelineno-6-11"></a>ib_read_bw<span class="w">      </span>bandwidth<span class="w"> </span><span class="nb">test</span><span class="w"> </span>with<span class="w"> </span>RDMA<span class="w"> </span><span class="nb">read</span><span class="w"> </span>transactions
</span><span id="__span-6-12"><a href="#__codelineno-6-12" id="__codelineno-6-12" name="__codelineno-6-12"></a>ib_atomic_lat<span class="w">   </span>latency<span class="w"> </span><span class="nb">test</span><span class="w"> </span>with<span class="w"> </span>atomic<span class="w"> </span>transactions
</span><span id="__span-6-13"><a href="#__codelineno-6-13" id="__codelineno-6-13" name="__codelineno-6-13"></a>ib_atomic_bw<span class="w">    </span>bandwidth<span class="w"> </span><span class="nb">test</span><span class="w"> </span>with<span class="w"> </span>atomic<span class="w"> </span>transactions
</span></code></pre></div>
<h4 id="iproute2">iproute2<a class="headerlink" href="#iproute2" title="Permanent link">¶</a></h4>
<p>强大的 iproute2 同样支持了 RDMA 网络接口的管理，提供了 <code>rdma</code> 命令，语法与 <code>ip</code> 命令类似：</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-7-1"><a href="#__codelineno-7-1" id="__codelineno-7-1" name="__codelineno-7-1"></a>ip<span class="w"> </span>link
</span><span id="__span-7-2"><a href="#__codelineno-7-2" id="__codelineno-7-2" name="__codelineno-7-2"></a>rdma<span class="w"> </span>link
</span></code></pre></div>
<h4 id="_5">其他<a class="headerlink" href="#_5" title="Permanent link">¶</a></h4>
<p>一个用于看 IB 卡实时流量的脚本：</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-8-1"><a href="#__codelineno-8-1" id="__codelineno-8-1" name="__codelineno-8-1"></a><span class="ch">#!/bin/bash</span>
</span><span id="__span-8-2"><a href="#__codelineno-8-2" id="__codelineno-8-2" name="__codelineno-8-2"></a>
</span><span id="__span-8-3"><a href="#__codelineno-8-3" id="__codelineno-8-3" name="__codelineno-8-3"></a><span class="c1"># Author: Chen Jinlong</span>
</span><span id="__span-8-4"><a href="#__codelineno-8-4" id="__codelineno-8-4" name="__codelineno-8-4"></a><span class="c1"># Usage: ib_monitor.sh [interval]</span>
</span><span id="__span-8-5"><a href="#__codelineno-8-5" id="__codelineno-8-5" name="__codelineno-8-5"></a>
</span><span id="__span-8-6"><a href="#__codelineno-8-6" id="__codelineno-8-6" name="__codelineno-8-6"></a><span class="nb">declare</span><span class="w"> </span>-A<span class="w"> </span>old_recv_bytes<span class="p">;</span>
</span><span id="__span-8-7"><a href="#__codelineno-8-7" id="__codelineno-8-7" name="__codelineno-8-7"></a><span class="nb">declare</span><span class="w"> </span>-A<span class="w"> </span>old_recv_packets<span class="p">;</span>
</span><span id="__span-8-8"><a href="#__codelineno-8-8" id="__codelineno-8-8" name="__codelineno-8-8"></a><span class="nb">declare</span><span class="w"> </span>-A<span class="w"> </span>old_xmit_bytes<span class="p">;</span>
</span><span id="__span-8-9"><a href="#__codelineno-8-9" id="__codelineno-8-9" name="__codelineno-8-9"></a><span class="nb">declare</span><span class="w"> </span>-A<span class="w"> </span>old_xmit_packets<span class="p">;</span>
</span><span id="__span-8-10"><a href="#__codelineno-8-10" id="__codelineno-8-10" name="__codelineno-8-10"></a>
</span><span id="__span-8-11"><a href="#__codelineno-8-11" id="__codelineno-8-11" name="__codelineno-8-11"></a><span class="nv">interval</span><span class="o">=</span><span class="nv">$1</span>
</span><span id="__span-8-12"><a href="#__codelineno-8-12" id="__codelineno-8-12" name="__codelineno-8-12"></a><span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span>-z<span class="w"> </span><span class="nv">$interval</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
</span><span id="__span-8-13"><a href="#__codelineno-8-13" id="__codelineno-8-13" name="__codelineno-8-13"></a><span class="w">    </span><span class="nv">interval</span><span class="o">=</span><span class="m">1</span>
</span><span id="__span-8-14"><a href="#__codelineno-8-14" id="__codelineno-8-14" name="__codelineno-8-14"></a><span class="k">fi</span>
</span><span id="__span-8-15"><a href="#__codelineno-8-15" id="__codelineno-8-15" name="__codelineno-8-15"></a>
</span><span id="__span-8-16"><a href="#__codelineno-8-16" id="__codelineno-8-16" name="__codelineno-8-16"></a><span class="k">for</span><span class="w"> </span>ib_dev<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="k">$(</span>ls<span class="w"> </span>/sys/class/infiniband/<span class="k">)</span><span class="p">;</span><span class="w"> </span><span class="k">do</span>
</span><span id="__span-8-17"><a href="#__codelineno-8-17" id="__codelineno-8-17" name="__codelineno-8-17"></a><span class="w">    </span><span class="nv">counter_dir</span><span class="o">=</span><span class="s2">"/sys/class/infiniband/</span><span class="nv">$ib_dev</span><span class="s2">/ports/1/counters"</span>
</span><span id="__span-8-18"><a href="#__codelineno-8-18" id="__codelineno-8-18" name="__codelineno-8-18"></a><span class="w">    </span>old_recv_bytes<span class="o">[</span><span class="nv">$ib_dev</span><span class="o">]=</span><span class="k">$(</span>cat<span class="w"> </span><span class="nv">$counter_dir</span>/port_rcv_data<span class="k">)</span>
</span><span id="__span-8-19"><a href="#__codelineno-8-19" id="__codelineno-8-19" name="__codelineno-8-19"></a><span class="w">    </span>old_recv_packets<span class="o">[</span><span class="nv">$ib_dev</span><span class="o">]=</span><span class="k">$(</span>cat<span class="w"> </span><span class="nv">$counter_dir</span>/port_rcv_packets<span class="k">)</span>
</span><span id="__span-8-20"><a href="#__codelineno-8-20" id="__codelineno-8-20" name="__codelineno-8-20"></a><span class="w">    </span>old_xmit_bytes<span class="o">[</span><span class="nv">$ib_dev</span><span class="o">]=</span><span class="k">$(</span>cat<span class="w"> </span><span class="nv">$counter_dir</span>/port_xmit_data<span class="k">)</span>
</span><span id="__span-8-21"><a href="#__codelineno-8-21" id="__codelineno-8-21" name="__codelineno-8-21"></a><span class="w">    </span>old_xmit_packets<span class="o">[</span><span class="nv">$ib_dev</span><span class="o">]=</span><span class="k">$(</span>cat<span class="w"> </span><span class="nv">$counter_dir</span>/port_xmit_packets<span class="k">)</span>
</span><span id="__span-8-22"><a href="#__codelineno-8-22" id="__codelineno-8-22" name="__codelineno-8-22"></a><span class="k">done</span>
</span><span id="__span-8-23"><a href="#__codelineno-8-23" id="__codelineno-8-23" name="__codelineno-8-23"></a>
</span><span id="__span-8-24"><a href="#__codelineno-8-24" id="__codelineno-8-24" name="__codelineno-8-24"></a><span class="k">while</span><span class="w"> </span>true<span class="p">;</span><span class="w"> </span><span class="k">do</span>
</span><span id="__span-8-25"><a href="#__codelineno-8-25" id="__codelineno-8-25" name="__codelineno-8-25"></a><span class="w">    </span><span class="nb">printf</span><span class="w"> </span><span class="s2">"%-10s %12s %12s %12s %12s\n"</span><span class="w"> </span>Device<span class="w"> </span>recv_MBps<span class="w"> </span>recv_kpps<span class="w"> </span>xmit_MBps<span class="w"> </span>xmit_kpps
</span><span id="__span-8-26"><a href="#__codelineno-8-26" id="__codelineno-8-26" name="__codelineno-8-26"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span>ib_dev<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="k">$(</span>ls<span class="w"> </span>/sys/class/infiniband/<span class="k">)</span><span class="p">;</span><span class="w"> </span><span class="k">do</span>
</span><span id="__span-8-27"><a href="#__codelineno-8-27" id="__codelineno-8-27" name="__codelineno-8-27"></a><span class="w">        </span><span class="nv">counter_dir</span><span class="o">=</span><span class="s2">"/sys/class/infiniband/</span><span class="nv">$ib_dev</span><span class="s2">/ports/1/counters"</span>
</span><span id="__span-8-28"><a href="#__codelineno-8-28" id="__codelineno-8-28" name="__codelineno-8-28"></a><span class="w">        </span><span class="nv">new_recv_bytes</span><span class="o">=</span><span class="k">$(</span>cat<span class="w"> </span><span class="nv">$counter_dir</span>/port_rcv_data<span class="k">)</span>
</span><span id="__span-8-29"><a href="#__codelineno-8-29" id="__codelineno-8-29" name="__codelineno-8-29"></a><span class="w">        </span><span class="nv">new_recv_packets</span><span class="o">=</span><span class="k">$(</span>cat<span class="w"> </span><span class="nv">$counter_dir</span>/port_rcv_packets<span class="k">)</span>
</span><span id="__span-8-30"><a href="#__codelineno-8-30" id="__codelineno-8-30" name="__codelineno-8-30"></a><span class="w">        </span><span class="nv">new_xmit_bytes</span><span class="o">=</span><span class="k">$(</span>cat<span class="w"> </span><span class="nv">$counter_dir</span>/port_xmit_data<span class="k">)</span>
</span><span id="__span-8-31"><a href="#__codelineno-8-31" id="__codelineno-8-31" name="__codelineno-8-31"></a><span class="w">        </span><span class="nv">new_xmit_packets</span><span class="o">=</span><span class="k">$(</span>cat<span class="w"> </span><span class="nv">$counter_dir</span>/port_xmit_packets<span class="k">)</span>
</span><span id="__span-8-32"><a href="#__codelineno-8-32" id="__codelineno-8-32" name="__codelineno-8-32"></a>
</span><span id="__span-8-33"><a href="#__codelineno-8-33" id="__codelineno-8-33" name="__codelineno-8-33"></a><span class="w">        </span><span class="nv">recv_MBps</span><span class="o">=</span><span class="k">$(</span><span class="nb">echo</span><span class="w"> </span><span class="s2">"scale=2; ( </span><span class="nv">$new_recv_bytes</span><span class="s2"> - </span><span class="si">${</span><span class="nv">old_recv_bytes</span><span class="p">[</span><span class="nv">$ib_dev</span><span class="p">]</span><span class="si">}</span><span class="s2"> ) / 256.0 / 1024.0 / </span><span class="nv">$interval</span><span class="s2">"</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>bc<span class="k">)</span>
</span><span id="__span-8-34"><a href="#__codelineno-8-34" id="__codelineno-8-34" name="__codelineno-8-34"></a><span class="w">        </span><span class="nv">recv_kpps</span><span class="o">=</span><span class="k">$(</span><span class="nb">echo</span><span class="w"> </span><span class="s2">"scale=2; ( </span><span class="nv">$new_recv_packets</span><span class="s2"> - </span><span class="si">${</span><span class="nv">old_recv_packets</span><span class="p">[</span><span class="nv">$ib_dev</span><span class="p">]</span><span class="si">}</span><span class="s2"> ) / 1000.0 / </span><span class="nv">$interval</span><span class="s2">"</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>bc<span class="k">)</span>
</span><span id="__span-8-35"><a href="#__codelineno-8-35" id="__codelineno-8-35" name="__codelineno-8-35"></a><span class="w">        </span><span class="nv">xmit_MBps</span><span class="o">=</span><span class="k">$(</span><span class="nb">echo</span><span class="w"> </span><span class="s2">"scale=2; ( </span><span class="nv">$new_xmit_bytes</span><span class="s2"> - </span><span class="si">${</span><span class="nv">old_xmit_bytes</span><span class="p">[</span><span class="nv">$ib_dev</span><span class="p">]</span><span class="si">}</span><span class="s2"> ) / 256.0 / 1024.0 / </span><span class="nv">$interval</span><span class="s2">"</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>bc<span class="k">)</span>
</span><span id="__span-8-36"><a href="#__codelineno-8-36" id="__codelineno-8-36" name="__codelineno-8-36"></a><span class="w">        </span><span class="nv">xmit_kpps</span><span class="o">=</span><span class="k">$(</span><span class="nb">echo</span><span class="w"> </span><span class="s2">"scale=2; ( </span><span class="nv">$new_xmit_packets</span><span class="s2"> - </span><span class="si">${</span><span class="nv">old_xmit_packets</span><span class="p">[</span><span class="nv">$ib_dev</span><span class="p">]</span><span class="si">}</span><span class="s2"> ) / 1000.0 / </span><span class="nv">$interval</span><span class="s2">"</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>bc<span class="k">)</span>
</span><span id="__span-8-37"><a href="#__codelineno-8-37" id="__codelineno-8-37" name="__codelineno-8-37"></a>
</span><span id="__span-8-38"><a href="#__codelineno-8-38" id="__codelineno-8-38" name="__codelineno-8-38"></a><span class="w">        </span><span class="nb">printf</span><span class="w"> </span><span class="s2">"%-10s %12s %12s %12s %12s\n"</span><span class="w"> </span><span class="nv">$ib_dev</span><span class="w"> </span><span class="nv">$recv_MBps</span><span class="w"> </span><span class="nv">$recv_kpps</span><span class="w"> </span><span class="nv">$xmit_MBps</span><span class="w"> </span><span class="nv">$xmit_kpps</span>
</span><span id="__span-8-39"><a href="#__codelineno-8-39" id="__codelineno-8-39" name="__codelineno-8-39"></a>
</span><span id="__span-8-40"><a href="#__codelineno-8-40" id="__codelineno-8-40" name="__codelineno-8-40"></a><span class="w">        </span>old_recv_bytes<span class="o">[</span><span class="nv">$ib_dev</span><span class="o">]=</span><span class="nv">$new_recv_bytes</span>
</span><span id="__span-8-41"><a href="#__codelineno-8-41" id="__codelineno-8-41" name="__codelineno-8-41"></a><span class="w">        </span>old_recv_packets<span class="o">[</span><span class="nv">$ib_dev</span><span class="o">]=</span><span class="nv">$new_recv_packets</span>
</span><span id="__span-8-42"><a href="#__codelineno-8-42" id="__codelineno-8-42" name="__codelineno-8-42"></a><span class="w">        </span>old_xmit_bytes<span class="o">[</span><span class="nv">$ib_dev</span><span class="o">]=</span><span class="nv">$new_xmit_bytes</span>
</span><span id="__span-8-43"><a href="#__codelineno-8-43" id="__codelineno-8-43" name="__codelineno-8-43"></a><span class="w">        </span>old_xmit_packets<span class="o">[</span><span class="nv">$ib_dev</span><span class="o">]=</span><span class="nv">$new_xmit_packets</span>
</span><span id="__span-8-44"><a href="#__codelineno-8-44" id="__codelineno-8-44" name="__codelineno-8-44"></a><span class="w">    </span><span class="k">done</span>
</span><span id="__span-8-45"><a href="#__codelineno-8-45" id="__codelineno-8-45" name="__codelineno-8-45"></a><span class="w">    </span><span class="nb">printf</span><span class="w"> </span><span class="s2">"\n"</span>
</span><span id="__span-8-46"><a href="#__codelineno-8-46" id="__codelineno-8-46" name="__codelineno-8-46"></a>
</span><span id="__span-8-47"><a href="#__codelineno-8-47" id="__codelineno-8-47" name="__codelineno-8-47"></a><span class="w">    </span>sleep<span class="w"> </span><span class="nv">$interval</span>
</span><span id="__span-8-48"><a href="#__codelineno-8-48" id="__codelineno-8-48" name="__codelineno-8-48"></a><span class="k">done</span>
</span></code></pre></div>
<h3 id="_6">用户空间库<a class="headerlink" href="#_6" title="Permanent link">¶</a></h3>
<p>阅读 <a href="https://github.com/linux-rdma/rdma-core"><span class="twemoji"><svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"></path></svg></span> linux-rdma/rdma-core</a> 的简介。</p>
<h4 id="linux-infiniband">Linux InfiniBand 软件结构<a class="headerlink" href="#linux-infiniband" title="Permanent link">¶</a></h4>
<div class="admonition quote">
<p class="admonition-title">Quote</p>
<ul>
<li><a href="https://docs.kernel.org/infiniband/index.html">InfiniBand - The Linux Kernel</a></li>
<li><a href="https://docs.oracle.com/cd/E19932-01/820-3523-10/ea_chpt3_software_overview.html">InfiniBand Software on Linux - Oracle</a></li>
<li><a href="https://docs.nvidia.com/cuda/archive/11.3.0/pdf/GPUDirect_RDMA.pdf">Developing a Linux Kernel module using RDMA for GPUDirect - NVIDIA</a></li>
</ul>
</div>
<p>Linux 内核中的 InifiniBand 可以分为三个层次：</p>
<ul>
<li>HCA Driver</li>
<li>Core InfiniBand Modules</li>
<li>Upper Level Protocols</li>
</ul>
<h4 id="rdma-verb">RDMA Verb<a class="headerlink" href="#rdma-verb" title="Permanent link">¶</a></h4>
<h4 id="infiniband-verb">InfiniBand Verb<a class="headerlink" href="#infiniband-verb" title="Permanent link">¶</a></h4>
<h4 id="ipoib">IPoIB<a class="headerlink" href="#ipoib" title="Permanent link">¶</a></h4>
<div class="admonition quote">
<p class="admonition-title">Quote</p>
<ul>
<li><a href="https://datatracker.ietf.org/doc/html/rfc4391">Transmission of IP over InfiniBand (IPoIB) - RFC 4391</a></li>
<li><a href="https://datatracker.ietf.org/doc/html/rfc4392">IP over InfiniBand (IPoIB) Architecture - RFC 4392</a></li>
<li><a href="https://docs.kernel.org/infiniband/ipoib.html">IP over InfiniBand - The Linux Kernel</a></li>
</ul>
</div>
<p>Linux 内核提供 <code>ib_ipoib</code> 驱动。</p>
<h4 id="nfs-over-rdma">NFS over RDMA<a class="headerlink" href="#nfs-over-rdma" title="Permanent link">¶</a></h4>
<h3 id="_7">内核子系统<a class="headerlink" href="#_7" title="Permanent link">¶</a></h3>
<p>阅读 <a href="https://github.com/torvalds/linux/blob/master/drivers/infiniband"><span class="twemoji"><svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"></path></svg></span> linux/drivers/infiniband</a>。</p>
<h4 id="hw">硬件驱动 <code>hw</code><a class="headerlink" href="#hw" title="Permanent link">¶</a></h4>
<p>你可以在 <code>hw</code> 下看到这里不仅有 InfiniBand 驱动，还有 RoCE 和 iWARP 等驱动。代码注释、内核模块的 Description 中会说明这是哪个厂商的驱动。下面举一些常见的例子：</p>
<ul>
<li>InfiniBand<ul>
<li><code>mlx4</code>: Mellanox ConnectX HCA InfiniBand driver</li>
<li><code>mlx5</code>: Mellanox 5th generation network adapters (ConnectX series) IB driver</li>
<li><code>mthca</code>: Mellanox InfiniBand HCA low-level driver</li>
</ul>
</li>
<li>RoCE<ul>
<li><code>erdma</code>：来自阿里巴巴</li>
<li><code>hns</code>：来自华为海思</li>
<li><code>irdma</code>: <a href="https://downloadmirror.intel.com/738730/README_irdma.txt">Linux* RDMA Driver for the E800 Series and X722 Intel(R) Ethernet Controllers</a></li>
</ul>
</li>
<li>iWARP<ul>
<li><code>cxgb3</code></li>
</ul>
</li>
</ul>
<p>此外你可能在远古文档中看见过 <code>amso</code>、<code>ipath</code> 等驱动。它们已经因为停止维护而被移出内核源码树。</p>
<p><code>mthca</code> 用于远古的 InfiniHost 系列产品。<a href="https://docs.nvidia.com/networking/display/ofedv502180/introduction">MLNX_OFED 文档</a> 详细解释了 <code>mlx4</code> 和 <code>mlx5</code> 这两个驱动。下图展示了这些驱动模块工作的位置。</p>
<figure>
<a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="auto" href="index.assets/mlx4_mlx5.webp"><img alt="mlx4_mlx5" src="index.assets/mlx4_mlx5.webp"/></a>
<figcaption>Mellanox ConnectX 驱动<br/>
<small>
<a href="https://docs.nvidia.com/networking/display/ofedv502180/introduction/">Mellanox OFED User Manual</a>
</small></figcaption>
</figure>
<ul>
<li>CX-3 和 CX-3 Pro 对应 <code>mlx4</code>，其后的产品对应 <code>mlx5</code>。</li>
<li>CX-3 既可以工作在 InfiniBand 模式，也可以工作在 Ethernet 模式。因此 <code>mlx4</code> 分为几个模块：<ul>
<li><code>mlx4_core</code></li>
<li><code>mlx4_ib</code></li>
<li><code>mlx4_en</code>，位于 <code>drivers/net/ethernet/mellanox/mlx4</code>。</li>
</ul>
</li>
<li>其后的产品也可以工作在 InfiniBand 和 Ethernet 模式，但以太网功能被合并到 <code>core</code> 中，因此不需要 <code>mlx5_en</code>（虽然这个驱动确实存在于 <code>drivers/net/ethernet/mellanox/mlx5</code> 中）：<ul>
<li><code>mlx5_core</code></li>
<li><code>mlx5_ib</code></li>
</ul>
</li>
</ul>
<p>MLNX_OFED 文档中还有驱动的参数等，可以参考。</p>
<h4 id="sw">软件驱动 <code>sw</code><a class="headerlink" href="#sw" title="Permanent link">¶</a></h4>
<ul>
<li><code>rxe</code>：软件实现的 RoCE。</li>
<li><code>siw</code>：Soft iWARP，软件实现的 iWARP。</li>
<li>
<p><code>rdmavt</code>：RDMA Verbs Transport Library。用于统一硬件驱动的一层，示意图如下：</p>
<p><figure markdown="span">
<a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="auto" href="index.assets/rdmavt.webp"><img alt="rdmavt" src="index.assets/rdmavt.webp"/></a>
<figcaption>
    RDMA Verbs Transport Library<br/>
<small>
<a href="https://www.openfabrics.org/images/eventpresos/2016presentations/203SoftwareVerbs.pdf">Creating a Common Software Verbs Implementation - OpenFabrics Alliance</a>
</small></figcaption>
</figure></p>
<p>举一个具体的作用：<code>rdmavt</code> 代表驱动调用 <code>ib_register_device()</code> 注册设备。</p>
<p>详细解释见 <a href="https://www.openfabrics.org/images/eventpresos/2016presentations/203SoftwareVerbs.pdf">Creating a Common Software Verbs Implementation - OpenFabrics Alliance</a>。</p>
</li>
</ul>
<h4 id="ulp">上层协议 <code>ulp</code><a class="headerlink" href="#ulp" title="Permanent link">¶</a></h4>
<p>在前文 <a href="#infiniband-协议栈">InfiniBand 协议栈</a> 中，我们已经介绍了 Upper Layer Protocols 用于将 InfiniBand 连接到常用的接口。在 <code>ulp</code> 中，我们可以看到这些协议的具体实现。其中值得探究的有：</p>
<ul>
<li><code>ipoib</code></li>
</ul>
<p>NFS over RDMA 虽然也是一个 ULP，但它似乎实现在 IPoIB 上，因此不出现在这里。</p>
<h4 id="core">核心模块 <code>core</code><a class="headerlink" href="#core" title="Permanent link">¶</a></h4>
<div class="admonition quote">
<p class="admonition-title">Quote</p>
<ul>
<li><a href="https://docs.kernel.org/driver-api/infiniband.html">InfiniBand and Remote DMA (RDMA) Interfaces — The Linux Kernel documentation</a></li>
</ul>
</div>
<p>TODO</p>
<h2 id="_8">硬件<a class="headerlink" href="#_8" title="Permanent link">¶</a></h2>
<p>前文语境中的 RDMA 指的是一种机制。考虑其具体实现，就涉及到多种技术。现有的 RDMA 技术包括 RoCE（RDMA over Converged Ethernet）、InfiniBand、iWARP 等。</p>
<figure>
<a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="auto" href="index.assets/rdma_arch_compare.webp"><img align="center" alt="rdma_arch_compare" src="index.assets/rdma_arch_compare.webp" width="80%"/></a>
<figcaption>
    RDMA 技术架构比较<br/>
<small>
<a href="https://cloud.tencent.com/developer/article/1771431">浅析 RoCE 网络技术 - 腾讯云</a>
</small></figcaption>
</figure>
<ul>
<li><strong>InfiniBand</strong>：专为 RDMA 设计的网络技术，从硬件级别保证可靠传输。<strong>需要专门的网络适配器、交换机。</strong></li>
<li><strong>RoCE 和 iWARP</strong>：都是基于以太网的 RDMA 技术，RoCE 使用 UDP 协议，iWARP 使用 TCP 协议。<ul>
<li><strong>Soft RoCE</strong>：可以以 Soft RoCE 的方式（使用 <a href="https://github.com/SoftRoCE/librxe-dev"><code>rxe</code> 驱动</a>）运行在普通以太网上，但在带宽和延迟上都和普通以太网没什么差别（见 <a href="https://www.ijcsit.com/docs/Volume%205/vol5issue01/ijcsit2014050168.pdf">Comparing Ethernet and soft Roce over 1 gigabit ethernet using osu benchmark - IJCSIT</a>）。</li>
<li><strong>聚合以太网（Converged Ethernet）</strong>：真正的 RoCE 就和它全名描述的一样，需要交换机和网络适配器支持聚合以太网。这是由 IEEE DCB 工作组提出的一组增强标准（比如 802.Qbb 流控、802.Qaz 传输选择、802.Qau 拥塞控制等）组成的，有两大目的：<ol>
<li>将存储、通信、计算等流量（如 iSCSI、FCoE、RDMA）<strong>整合</strong>到一套共享的以太网基础设施上，这就是“聚合”的意思。</li>
<li>支持<strong>不丢包</strong>传输，从而支持对传输可靠性要求极高的服务（比如 RDMA）。</li>
</ol>
</li>
</ul>
</li>
<li>其他专有技术：如 Intel 的 Omni-Path。</li>
</ul>
<h3 id="infiniband">InfiniBand<a class="headerlink" href="#infiniband" title="Permanent link">¶</a></h3>
<div class="admonition quote">
<p class="admonition-title">Quote</p>
<ul>
<li><a href="https://wiki.debian.org/RDMA">RDMA - Debian Wiki</a></li>
<li><a href="https://www.openfabrics.org/ofed-for-linux/">OFED for Linux – OpenFabrics Alliance</a></li>
<li><a href="https://mug.mvapich.cse.ohio-state.edu/static/media/mug/presentations/19/shainer-mug-19.pdf">InfiniBand In-Network Computing Technology and Roadmap - Mellanox</a></li>
</ul>
</div>
<p>下面两张图是 InfiniBand 技术栈。可以看到 InfiniBand 是一套系统的解决方案，包含网络适配器、交换机、SoC、线缆和软件生态。</p>
<figure>
<a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="auto" href="index.assets/ib_tech_roadmap_2015.webp"><img alt="ib_tech_roadmap_2015" src="index.assets/ib_tech_roadmap_2015.webp" style="float: left" width="45%"/></a>
<a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="auto" href="index.assets/ib_tech_roadmap_2019.webp"><img alt="ib_tech_roadmap_2019" src="index.assets/ib_tech_roadmap_2019.webp" width="55%"/></a>
<figcaption>
    InfiniBand 技术路线<br/>
    左 2015 年，右 2019 年<br/>
<small>
<a href="https://www.hpcwire.com/2015/11/16/mellanox-touts-arrival-of-intelligent-interconnect/">Mellanox Touts Arrival of Intelligent Interconnect - HPC Wire</a><br/>
<a href="https://mug.mvapich.cse.ohio-state.edu/static/media/mug/presentations/19/shainer-mug-19.pdf">InfiniBand In-Network Computing Technology and Roadmap - MVAPICH</a>
</small></figcaption>
</figure>
<ul>
<li><strong>提供商</strong>：NVIDIA Mellanox 仅此一家。</li>
<li>
<p><strong>内核支持情况</strong>：</p>
<ul>
<li><strong>子系统</strong>：Linux 内核将 InfiniBand 作为一个驱动子系统提供支持，见 <a href="https://docs.kernel.org/driver-api/infiniband.html">InfiniBand and Remote DMA (RDMA) Interfaces — The Linux Kernel documentation</a>。</li>
<li>
<p><strong>用户空间</strong>：只有内核接口是不够的，还需要用户空间的库和工具。内核团队维护了一套用户空间库和工具，见 <a href="https://github.com/linux-rdma/rdma-core"><span class="twemoji"><svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"></path></svg></span> linux-rdma/rdma-core: RDMA core userspace libraries and daemons</a>。</p>
<p>它提供了两个重要的库（包含 C/C++ 和 Python 绑定），大多数 RDMA 应用都基于它们开发：</p>
<ul>
<li><code>librdmacm</code>：使用 IP 寻址建立连接，比 <code>libibverbs</code> 抽象程度更高，对于写过 socket 程序的人来说更容易上手。</li>
<li><code>libibverbs</code>：提供其他控制和数据通路操作，实现 InfiniBand Trade Association（IBTA）定义的抽象接口。</li>
</ul>
<p><figure markdown="span">
<a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="auto" href="index.assets/rdma_core.webp"><img align="center" alt="rdma_core" src="index.assets/rdma_core.webp" width="50%"/></a>
<figcaption>
    RDMA 栈
    <br/><small>
<a href="https://netdevconf.info/0x16/slides/40/RDMA%20Tutorial.pdf">RDMA Tutorial - Netdev</a>
</small></figcaption></figure></p>
</li>
</ul>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>这也就是说 Linux 不安装厂商的驱动也可以使用 InfiniBand。比如 NVIDIA 停止了 ConnectX-3 在 Debian 10 之后的 MLNX_OFED 版本的支持，但用内核中的 rdma-core 等仍然可以使用。通过 rdma-core，我们在 Debian 12 中成功使用了 ConnectX-3 卡。</p>
</div>
</li>
<li>
<p><strong>产商支持</strong>：</p>
<ul>
<li><strong><a href="https://www.openfabrics.org/ofa-overview/">OpenFabrics</a></strong>：OFA 联盟负责开发、测试、许可、支持和分发 RDMA/先进网络软件，目标是促进先进网络架构的发展与普及。成员包括 Mellanox、HUAWEI、Intel、IBM、Red Hat、Microsoft 等厂商和 SNIA 等标准组织。OpenFabrics 曾经是 OpenIB Alliance，但后来扩展支持了 iWARP、RoCE 等。</li>
<li><strong><a href="https://www.openfabrics.org/ofed-for-linux/">OpenFabrics Enterprise Distribution（OFED）</a></strong>：产商们从 linux-rdma 拉取源代码，针对自己的产品进行优化、修改、打补丁等。非常重要的是它提供了<strong>内核旁路（kernel bypass）</strong>功能，一些应用程序可以直接访问硬件资源，极大提高性能。此外，适配器和线缆等的<strong>固件更新</strong>也需要产商的工具。</li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>MLNX_OFED 已经停止支持，将转移到 DOCA-OFED。</p>
</div>
</li>
</ul>
<h4 id="infiniband_1">InfiniBand 硬件<a class="headerlink" href="#infiniband_1" title="Permanent link">¶</a></h4>
<p>InfiniBand 标准中定义的硬件组成部分有：</p>
<ul>
<li><strong>Host Channel Adapter（HCA）</strong>：可以理解为网络适配器。</li>
<li><strong>Target Channel Adapter（TCA）</strong>：可以理解为嵌入式系统的网络适配器。</li>
<li><strong>Switch</strong>：实现了 InfiniBand 链路层流控的交换机，能够不丢包传输。</li>
<li><strong>Router</strong>：用于大型网络。IB 管理架构以子网为单位，通过路由器分隔子网能够减少管理流量在整个网络中的传输。</li>
<li><strong>Cable and Connector</strong>：</li>
</ul>
<h5 id="host-channel-adapter">Host Channel Adapter<a class="headerlink" href="#host-channel-adapter" title="Permanent link">¶</a></h5>
<p>网络适配器</p>
<p>NVIDIA Mellanox 制造的网络适配器系列名称为 ConnectX。这些网络适配器一般支持 InfiniBand 或 RoCE 模式，可灵活配置。</p>
<table>
<thead>
<tr>
<th style="text-align: left;"><strong>Feature</strong></th>
<th style="text-align: left;"><strong>ConnectX-3</strong></th>
<th style="text-align: left;"><strong>ConnectX-4</strong></th>
<th style="text-align: left;"><strong>ConnectX-5</strong></th>
<th style="text-align: left;"><strong>ConnectX-6</strong></th>
<th style="text-align: left;"><strong>ConnectX-7</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">Speed</td>
<td style="text-align: left;">56Gb/s</td>
<td style="text-align: left;">100Gb/s</td>
<td style="text-align: left;">100Gb/s</td>
<td style="text-align: left;">200Gb/s</td>
<td style="text-align: left;">400Gb/s</td>
</tr>
<tr>
<td style="text-align: left;">Connector</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">QSFP28</td>
<td style="text-align: left;">QSFP56</td>
<td style="text-align: left;">OSFP, QSFP112</td>
</tr>
<tr>
<td style="text-align: left;">PCIe</td>
<td style="text-align: left;">x8 Gen3</td>
<td style="text-align: left;">x8, x16 Gen3</td>
<td style="text-align: left;">Gen3/4 x16</td>
<td style="text-align: left;">Gen3/4 x16</td>
<td style="text-align: left;">Gen4/5 x16</td>
</tr>
<tr>
<td style="text-align: left;">IB RDMA / RoCE</td>
<td style="text-align: left;">IB RDMA, RoCE*</td>
<td style="text-align: left;">IB RDMA, RoCE</td>
<td style="text-align: left;">IB RDMA, RoCE</td>
<td style="text-align: left;">IB RDMA, RoCE</td>
<td style="text-align: left;">IB RDMA, RoCE</td>
</tr>
<tr>
<td style="text-align: left;">SR-IOV</td>
<td style="text-align: left;">Supported</td>
<td style="text-align: left;">Supported</td>
<td style="text-align: left;">Supported</td>
<td style="text-align: left;">Supported</td>
<td style="text-align: left;">Supported</td>
</tr>
</tbody>
</table>
<p><small>这张表来自 <a href="https://enterprise-support.nvidia.com/s/article/mellanox-adapters---comparison-table">Mellanox Adapters - Comparison Table</a> 以及 <a href="https://nvdam.widen.net/s/cprk9mhfzq/networking-datasheet-infiniband-adapter-cards---web--1549706">Networking-datasheet-InfiniBand-Adapter-Cards---web--1549706.pdf (widen.net)</a>。</small></p>
<p>NVIDIA 是 InfiniBand 技术的唯一供应商，目前其他厂家最多只能制造 IB 线缆。而 RoCE 技术则有众多 ICT 厂商支持，如 Cisco、华为、Juniper 等。</p>
<h5 id="_9">线缆<a class="headerlink" href="#_9" title="Permanent link">¶</a></h5>
<p>InfiniBand 线缆端子上有 EEPROM 芯片，可以存储线缆的信息，如长度、型号、序列号等。</p>
<h5 id="_10">交换机<a class="headerlink" href="#_10" title="Permanent link">¶</a></h5>
<h4 id="infiniband_2">InfiniBand 协议栈<a class="headerlink" href="#infiniband_2" title="Permanent link">¶</a></h4>
<div class="admonition quote">
<p class="admonition-title">Quote</p>
<ul>
<li>Presentation:<ul>
<li><a href="https://www.snia.org/sites/default/files/files2/files2/SDC2013/presentations/Hardware/DavidDeming_Infiniband_Architectural_Overview.pdf">(2013)InfiniBand Architecture Overview - SNIA</a></li>
<li><a href="https://www.snia.org/sites/default/education/tutorials/2008/spring/networking/Goldenberg-D_InfiniBand_Technology_Overview.pdf">(2008)InfiniBand Technology Overview - SNIA</a></li>
</ul>
</li>
<li>White Paper:<ul>
<li><a href="https://network.nvidia.com/pdf/whitepapers/IB_Intro_WP_190.pdf">(2003)Introduction to InfiniBand™ - NVIDIA</a></li>
<li><a href="https://network.nvidia.com/pdf/whitepapers/Intro_to_IB_for_End_Users.pdf">(2010)Introduction to InfiniBand™ for End Users - NVIDIA</a></li>
</ul>
</li>
<li>Specification: <a href="https://www.afs.enea.it/asantoro/V1r1_2_1.Release_12062007.pdf">(2007)InfiniBand Architecture Release 1.2.1 - ENEA</a></li>
</ul>
</div>
<p>让我们忽略负责路由的网络层及更低层次，从 Transport Layer 开始。在传输层中，InfiniBand 双端建立消息队列（Queue Pair）进行通信。定义以下 Transport Functions：SEND、RDMA Write、RDMA Read、ATOMIC、Memory Binding。这些操作在不同服务等级（Transport Service Level）中的可用性不同。</p>
<p>SM：子网管理器。The InfiniBand Subnet Manager (SM) is a centralized entity running in the switch. The SM discovers and configures all the InfiniBand fabric devices to enable traffic flow between those devices. 每个 IB 网络中都需要一个 SM，否则 ibstat 一直会处于 Initializing 的状态。在 Switchless IB Network 中，其中的一台机器应当启动 OpenSM（在 LInux Kernel 中，一般发行版都会带）。用 sudo 启动 opensm，或者用 systemctl 启动 opensmd.service 即可。</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-9-1"><a href="#__codelineno-9-1" id="__codelineno-9-1" name="__codelineno-9-1"></a>The installation of OpenSM includes:
</span><span id="__span-9-2"><a href="#__codelineno-9-2" id="__codelineno-9-2" name="__codelineno-9-2"></a>sbin/
</span><span id="__span-9-3"><a href="#__codelineno-9-3" id="__codelineno-9-3" name="__codelineno-9-3"></a>   opensm - the SM/SA executable
</span><span id="__span-9-4"><a href="#__codelineno-9-4" id="__codelineno-9-4" name="__codelineno-9-4"></a>   osmtest - a test program for the SM/SA
</span><span id="__span-9-5"><a href="#__codelineno-9-5" id="__codelineno-9-5" name="__codelineno-9-5"></a>lib/
</span><span id="__span-9-6"><a href="#__codelineno-9-6" id="__codelineno-9-6" name="__codelineno-9-6"></a>   libosmcomp.{a,so} - component library with generic services and containers
</span><span id="__span-9-7"><a href="#__codelineno-9-7" id="__codelineno-9-7" name="__codelineno-9-7"></a>   libopensm.{a,so} - opensm services for logs and mad buffer pool
</span><span id="__span-9-8"><a href="#__codelineno-9-8" id="__codelineno-9-8" name="__codelineno-9-8"></a>   libosmvendor.{a,so} - interface to the user mad service of the driver
</span><span id="__span-9-9"><a href="#__codelineno-9-9" id="__codelineno-9-9" name="__codelineno-9-9"></a>include/
</span><span id="__span-9-10"><a href="#__codelineno-9-10" id="__codelineno-9-10" name="__codelineno-9-10"></a>   iba/ib_types.h - IBA types header file
</span><span id="__span-9-11"><a href="#__codelineno-9-11" id="__codelineno-9-11" name="__codelineno-9-11"></a>   complib/ - component library includes
</span><span id="__span-9-12"><a href="#__codelineno-9-12" id="__codelineno-9-12" name="__codelineno-9-12"></a>   vendor/  - vendor library includes
</span><span id="__span-9-13"><a href="#__codelineno-9-13" id="__codelineno-9-13" name="__codelineno-9-13"></a>   opensm/  - public opensm library includes
</span></code></pre></div>
<h3 id="roce">RoCE<a class="headerlink" href="#roce" title="Permanent link">¶</a></h3>
<details class="quote">
<summary>Quote</summary>
<ul>
<li><a href="http://www.bj-joynet.com/static/upload/file/20221025/1666684563267006.pdf">端到端 RoCE 概念原理与部署调优</a>：大部分是实际操作，没有清晰的理论讲解。</li>
</ul>
</details>
<p>RoCE 协议存在 RoCEv1 和 RoCEv2 两个版本，取决于所使用的网络适配器。</p>
<ul>
<li>RoCE v1：基于以太网<strong>链路层</strong>实现的 RDMA 协议（交换机需要支持 PFC 等流控技术，在物理层保证可靠传输）。</li>
<li>RoCE v2：封装为 <strong>UDP（端口 4791） + IPv4/IPv6</strong>，从而实现 L3 路由功能。可以跨 VLAN、进行 IP 组播了。RoCEv2 可以工作在 Lossless 和 Lossy 模式下。<ul>
<li>Lossless：适用于数据中心网络，要求交换机支持 DCB（Data Center Bridging）技术。</li>
</ul>
</li>
</ul>
<p>RoCE 包格式：</p>
<figure>
<a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="auto" href="index.assets/roce_packet_infiniband.webp"><img align="center" alt="rdma_packet_infiniband" src="index.assets/roce_packet_infiniband.webp" width="80%"/></a>
<a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="auto" href="index.assets/roce_packet_version.webp"><img align="center" alt="roce_packet_version" src="index.assets/roce_packet_version.webp" width="80%"/></a>
<figcaption>
    RoCE 包格式
    <br/><small>
<a href="https://community.fs.com/hk/article/roce-rdma-over-converged-ethernet.html">RoCE 指南 - FS</a>
</small></figcaption></figure>
<h4 id="soft-roce">Soft-RoCE<a class="headerlink" href="#soft-roce" title="Permanent link">¶</a></h4>
<p>基于 Socket 实现的 RoCE。</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-10-1"><a href="#__codelineno-10-1" id="__codelineno-10-1" name="__codelineno-10-1"></a>modprobe<span class="w"> </span>rdma_rxe
</span><span id="__span-10-2"><a href="#__codelineno-10-2" id="__codelineno-10-2" name="__codelineno-10-2"></a>rdma<span class="w"> </span>link<span class="w"> </span>add<span class="w"> </span>rxe_0<span class="w"> </span><span class="nb">type</span><span class="w"> </span>rxe<span class="w"> </span>netdev<span class="w"> </span>&lt;dev&gt;
</span></code></pre></div>
<h3 id="iwarp">iWARP<a class="headerlink" href="#iwarp" title="Permanent link">¶</a></h3>
<h4 id="soft-iwarp">Soft-iWARP<a class="headerlink" href="#soft-iwarp" title="Permanent link">¶</a></h4>
<p>内核模块名为 <code>siw</code>，同上。</p>
<hr/>
<p>待整理</p>
<div class="admonition quote">
<p class="admonition-title">参考资料</p>
<p>这里是一些参考资料，它们目前没有被本笔记使用，其中的内容有待挖掘。</p>
<ul>
<li><a href="https://www.zhihu.com/people/ssbandjl/posts">晓兵 - 知乎</a>：有一些源码解析和前沿技术的讨论。</li>
</ul>
</div>
<h2 id="_11">传统网络栈的不足<a class="headerlink" href="#_11" title="Permanent link">¶</a></h2>
<div class="admonition quote">
<p class="admonition-title">Quote</p>
<ul>
<li><a href="https://github.com/ofiwg/ofi-guide/blob/master/OFIGuide.md">ofi-guide/OFIGuide.md at master · ofiwg/ofi-guide</a></li>
</ul>
</div>
<h3 id="non-blocking-socket">Non-blocking Socket<a class="headerlink" href="#non-blocking-socket" title="Permanent link">¶</a></h3>
<div class="admonition quote">
<p class="admonition-title">Quote</p>
<ul>
<li><a href="https://github.com/holmofy/echo-server"><span class="twemoji"><svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"></path></svg></span> holmofy/echo-server</a></li>
</ul>
</div>
<p>在课堂上，我们学习过 Socket 编程的基本方法。在实践中，更多应用使用 non-blocking socket：</p>
<div class="language-c highlight"><pre><span></span><code><span id="__span-11-1"><a href="#__codelineno-11-1" id="__codelineno-11-1" name="__codelineno-11-1"></a><span class="cm">/* Example server code flow to initiate listen */</span>
</span><span id="__span-11-2"><a href="#__codelineno-11-2" id="__codelineno-11-2" name="__codelineno-11-2"></a><span class="k">struct</span><span class="w"> </span><span class="nc">addrinfo</span><span class="w"> </span><span class="o">*</span><span class="n">ai</span><span class="p">,</span><span class="w"> </span><span class="n">hints</span><span class="p">;</span>
</span><span id="__span-11-3"><a href="#__codelineno-11-3" id="__codelineno-11-3" name="__codelineno-11-3"></a><span class="kt">int</span><span class="w"> </span><span class="n">listen_fd</span><span class="p">;</span>
</span><span id="__span-11-4"><a href="#__codelineno-11-4" id="__codelineno-11-4" name="__codelineno-11-4"></a>
</span><span id="__span-11-5"><a href="#__codelineno-11-5" id="__codelineno-11-5" name="__codelineno-11-5"></a><span class="n">memset</span><span class="p">(</span><span class="o">&amp;</span><span class="n">hints</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="k">sizeof</span><span class="w"> </span><span class="n">hints</span><span class="p">);</span>
</span><span id="__span-11-6"><a href="#__codelineno-11-6" id="__codelineno-11-6" name="__codelineno-11-6"></a><span class="n">hints</span><span class="p">.</span><span class="n">ai_socktype</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SOCK_STREAM</span><span class="p">;</span>
</span><span id="__span-11-7"><a href="#__codelineno-11-7" id="__codelineno-11-7" name="__codelineno-11-7"></a><span class="n">hints</span><span class="p">.</span><span class="n">ai_flags</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AI_PASSIVE</span><span class="p">;</span>
</span><span id="__span-11-8"><a href="#__codelineno-11-8" id="__codelineno-11-8" name="__codelineno-11-8"></a><span class="n">getaddrinfo</span><span class="p">(</span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="s">"7471"</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">hints</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">ai</span><span class="p">);</span>
</span><span id="__span-11-9"><a href="#__codelineno-11-9" id="__codelineno-11-9" name="__codelineno-11-9"></a>
</span><span id="__span-11-10"><a href="#__codelineno-11-10" id="__codelineno-11-10" name="__codelineno-11-10"></a><span class="n">listen_fd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">socket</span><span class="p">(</span><span class="n">ai</span><span class="o">-&gt;</span><span class="n">ai_family</span><span class="p">,</span><span class="w"> </span><span class="n">SOCK_STREAM</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
</span><span id="__span-11-11"><a href="#__codelineno-11-11" id="__codelineno-11-11" name="__codelineno-11-11"></a><span class="n">bind</span><span class="p">(</span><span class="n">listen_fd</span><span class="p">,</span><span class="w"> </span><span class="n">ai</span><span class="o">-&gt;</span><span class="n">ai_addr</span><span class="p">,</span><span class="w"> </span><span class="n">ai</span><span class="o">-&gt;</span><span class="n">ai_addrlen</span><span class="p">);</span>
</span><span id="__span-11-12"><a href="#__codelineno-11-12" id="__codelineno-11-12" name="__codelineno-11-12"></a><span class="n">freeaddrinfo</span><span class="p">(</span><span class="n">ai</span><span class="p">);</span>
</span><span id="__span-11-13"><a href="#__codelineno-11-13" id="__codelineno-11-13" name="__codelineno-11-13"></a>
</span><span id="__span-11-14"><a href="#__codelineno-11-14" id="__codelineno-11-14" name="__codelineno-11-14"></a><span class="n">fcntl</span><span class="p">(</span><span class="n">listen_fd</span><span class="p">,</span><span class="w"> </span><span class="n">F_SETFL</span><span class="p">,</span><span class="w"> </span><span class="n">O_NONBLOCK</span><span class="p">);</span>
</span><span id="__span-11-15"><a href="#__codelineno-11-15" id="__codelineno-11-15" name="__codelineno-11-15"></a><span class="n">listen</span><span class="p">(</span><span class="n">listen_fd</span><span class="p">,</span><span class="w"> </span><span class="mi">128</span><span class="p">);</span>
</span><span id="__span-11-16"><a href="#__codelineno-11-16" id="__codelineno-11-16" name="__codelineno-11-16"></a>
</span><span id="__span-11-17"><a href="#__codelineno-11-17" id="__codelineno-11-17" name="__codelineno-11-17"></a><span class="cm">/* Example server code flow to accept a connection */</span>
</span><span id="__span-11-18"><a href="#__codelineno-11-18" id="__codelineno-11-18" name="__codelineno-11-18"></a><span class="k">struct</span><span class="w"> </span><span class="nc">pollfd</span><span class="w"> </span><span class="n">fds</span><span class="p">;</span>
</span><span id="__span-11-19"><a href="#__codelineno-11-19" id="__codelineno-11-19" name="__codelineno-11-19"></a><span class="kt">int</span><span class="w"> </span><span class="n">server_fd</span><span class="p">;</span>
</span><span id="__span-11-20"><a href="#__codelineno-11-20" id="__codelineno-11-20" name="__codelineno-11-20"></a>
</span><span id="__span-11-21"><a href="#__codelineno-11-21" id="__codelineno-11-21" name="__codelineno-11-21"></a><span class="n">fds</span><span class="p">.</span><span class="n">fd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">listen_fd</span><span class="p">;</span>
</span><span id="__span-11-22"><a href="#__codelineno-11-22" id="__codelineno-11-22" name="__codelineno-11-22"></a><span class="n">fds</span><span class="p">.</span><span class="n">events</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">POLLIN</span><span class="p">;</span>
</span><span id="__span-11-23"><a href="#__codelineno-11-23" id="__codelineno-11-23" name="__codelineno-11-23"></a>
</span><span id="__span-11-24"><a href="#__codelineno-11-24" id="__codelineno-11-24" name="__codelineno-11-24"></a><span class="n">poll</span><span class="p">(</span><span class="o">&amp;</span><span class="n">fds</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">);</span>
</span><span id="__span-11-25"><a href="#__codelineno-11-25" id="__codelineno-11-25" name="__codelineno-11-25"></a>
</span><span id="__span-11-26"><a href="#__codelineno-11-26" id="__codelineno-11-26" name="__codelineno-11-26"></a><span class="n">server_fd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">accept</span><span class="p">(</span><span class="n">listen_fd</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
</span><span id="__span-11-27"><a href="#__codelineno-11-27" id="__codelineno-11-27" name="__codelineno-11-27"></a><span class="n">fcntl</span><span class="p">(</span><span class="n">server_fd</span><span class="p">,</span><span class="w"> </span><span class="n">F_SETFL</span><span class="p">,</span><span class="w"> </span><span class="n">O_NONBLOCK</span><span class="p">);</span>
</span><span id="__span-11-28"><a href="#__codelineno-11-28" id="__codelineno-11-28" name="__codelineno-11-28"></a>
</span><span id="__span-11-29"><a href="#__codelineno-11-29" id="__codelineno-11-29" name="__codelineno-11-29"></a><span class="cm">/* Example of server receiving data from client */</span>
</span><span id="__span-11-30"><a href="#__codelineno-11-30" id="__codelineno-11-30" name="__codelineno-11-30"></a><span class="k">struct</span><span class="w"> </span><span class="nc">pollfd</span><span class="w"> </span><span class="n">fds</span><span class="p">;</span>
</span><span id="__span-11-31"><a href="#__codelineno-11-31" id="__codelineno-11-31" name="__codelineno-11-31"></a><span class="kt">size_t</span><span class="w"> </span><span class="n">offset</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="p">,</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span>
</span><span id="__span-11-32"><a href="#__codelineno-11-32" id="__codelineno-11-32" name="__codelineno-11-32"></a><span class="kt">char</span><span class="w"> </span><span class="n">buf</span><span class="p">[</span><span class="mi">4096</span><span class="p">];</span>
</span><span id="__span-11-33"><a href="#__codelineno-11-33" id="__codelineno-11-33" name="__codelineno-11-33"></a>
</span><span id="__span-11-34"><a href="#__codelineno-11-34" id="__codelineno-11-34" name="__codelineno-11-34"></a><span class="n">fds</span><span class="p">.</span><span class="n">fd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">server_fd</span><span class="p">;</span>
</span><span id="__span-11-35"><a href="#__codelineno-11-35" id="__codelineno-11-35" name="__codelineno-11-35"></a><span class="n">fds</span><span class="p">.</span><span class="n">events</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">POLLIN</span><span class="p">;</span>
</span><span id="__span-11-36"><a href="#__codelineno-11-36" id="__codelineno-11-36" name="__codelineno-11-36"></a>
</span><span id="__span-11-37"><a href="#__codelineno-11-37" id="__codelineno-11-37" name="__codelineno-11-37"></a><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">buf</span><span class="p">);</span>
</span><span id="__span-11-38"><a href="#__codelineno-11-38" id="__codelineno-11-38" name="__codelineno-11-38"></a><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">offset</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">offset</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">size</span><span class="p">;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-11-39"><a href="#__codelineno-11-39" id="__codelineno-11-39" name="__codelineno-11-39"></a><span class="w">    </span><span class="n">poll</span><span class="p">(</span><span class="o">&amp;</span><span class="n">fds</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">);</span>
</span><span id="__span-11-40"><a href="#__codelineno-11-40" id="__codelineno-11-40" name="__codelineno-11-40"></a>
</span><span id="__span-11-41"><a href="#__codelineno-11-41" id="__codelineno-11-41" name="__codelineno-11-41"></a><span class="w">    </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">recv</span><span class="p">(</span><span class="n">client_fd</span><span class="p">,</span><span class="w"> </span><span class="n">buf</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">offset</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">offset</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
</span><span id="__span-11-42"><a href="#__codelineno-11-42" id="__codelineno-11-42" name="__codelineno-11-42"></a><span class="w">    </span><span class="n">offset</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span>
</span><span id="__span-11-43"><a href="#__codelineno-11-43" id="__codelineno-11-43" name="__codelineno-11-43"></a><span class="p">}</span>
</span></code></pre></div>
<p>在高并发场景下，non-blocking socket 是必不可少的：</p>
<ul>
<li><strong>并发和响应性：</strong> 等待网络操作时可以处理其他任务，单个线程能够处理多个连接。</li>
<li><strong>资源利用率：</strong> 通过 <code>select</code> 和 <code>poll</code> 等 I/O 多路复用技术，高效处理多个连接。与阻塞式模型为每个连接创建一个线程相比，non-blocking socket 减少了线程开销。</li>
</ul>
<h3 id="socket">Socket 的不足<a class="headerlink" href="#socket" title="Permanent link">¶</a></h3>
<p>在分析不足前，首先肯定 Socket 的两大优点：</p>
<ul>
<li><strong>通用性：</strong> 适用于各种网络设备和协议。</li>
<li><strong>易用性：</strong> 编程简单，这是非常重要的一点。提供更高性能的 API 都比 Socket 更难编程。类比 C/C++ 与汇编，对于大多数程序员来说，编写 C/C++ 程序的性能更高。因此选择 Socket 之外的 API 时，需要有明确的需求。</li>
</ul>
<p>但 Socket 无法满足高性能网络的三点需求：</p>
<ul>
<li>
<p><strong>避免内存拷贝：</strong> 我们分别考虑发送和接收端的处理过程</p>
<ul>
<li><strong>发送端：</strong> <code>send()</code> 返回时，应用程序可以重用缓冲区。然而只有对方 ACK，才能确保数据成功送达。网络栈有两种选择：阻塞，等待 ACK 返回；立即返回，但需要将数据拷贝到内核缓冲区，等待 ACK 释放。</li>
<li><strong>接收端：</strong> 网络适配器收到数据包后放入内核缓冲区，否则丢弃。要避免拷贝，唯一的方法就是在 <code>send()</code> 前调用 <code>recv()</code>，然而这会阻塞接收端，且在大部分情况下无法满足。</li>
</ul>
<p>可以看到，操作系统网络栈不得不维护缓冲区，造成数据在应用程序和网络栈之间的拷贝。</p>
<p>如果能够支持将数据直接写入特定的内存区域，将显著提升某些应用的性能。例如：数据库可能希望将收到的记录合并到表中。</p>
</li>
<li>
<p><strong>异步操作：</strong> Socket API 以同步方式运行。要使用 Socket 进行异步操作，就会产生额外的拷贝。</p>
</li>
<li>
<p><strong>直接访问硬件：</strong></p>
</li>
</ul>
<hr/>
<p>待整理</p>
<h2 id="rdma_1">RDMA 基本概念<a class="headerlink" href="#rdma_1" title="Permanent link">¶</a></h2>
<div class="admonition quote">
<p class="admonition-title">Quote</p>
</div>
<h3 id="_12">注册内存区域<a class="headerlink" href="#_12" title="Permanent link">¶</a></h3>
<p>RDMA 通信前，需要先注册内存区域 <strong>MR（memory region）</strong>，供 RDMA 设备访问：</p>
<ul>
<li>内存页面必须被 Pin 住不可换出。</li>
<li>注册时获得 <strong>L_Key（local key）</strong> 和 <strong>R_Key（remote key）</strong>。前者用于本地访问，后者用于远程访问。</li>
</ul>
<h4 id="_13">交换信息<a class="headerlink" href="#_13" title="Permanent link">¶</a></h4>
<p>在进行 RDMA 通信前，通信双方需要交换 R_Key 和 QP 等信息。可以先通过以太网建立 TCP 连接，或者使用 <code>rdma_cm</code> 管理 RDMA 连接。</p>
<h4 id="_14">异步通信<a class="headerlink" href="#_14" title="Permanent link">¶</a></h4>
<p>RDMA 基于三个队列进行<strong>异步</strong>通信：</p>
<ul>
<li>Send、Receive 队列用于<strong>调度</strong>工作（work）。这两个队列也合称为 <strong>Queue Pair（QP）</strong>。</li>
<li>Completion 队列用于<strong>通知</strong>工作完成。</li>
</ul>
<p>RDMA 通信流程如下：</p>
<ul>
<li>应用程序将 <strong>WR（work request，也称为 work queue element）</strong>放入（post）到 Send 或 Receive 队列。</li>
<li>WR 中含有 <strong>SGE（Scatter/Gather Elements）</strong>，指向 RDMA 设备可以访问的一块 MR 区域。在 Send 队列中指向发送数据，Receive 队列中指向接收数据。</li>
<li>WR 完成后，RDMA 设备创建 <strong>WC（work completion，也称为 completion queue element）</strong>放入 Completion 队列。应用向适配器轮询（poll）Completion 队列，获取 WC。</li>
</ul>
<p>对于一个应用，QP 和 CQ 可以是多对一的关系。QP、CQ 和 MR 都定义在一个 <strong>Protection Domain（PD）</strong> 中。</p>
<figure>
<a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="auto" href="index.assets/rdma_queue_pair.webp"><img align="center" alt="rdma_queue_pair" src="index.assets/rdma_queue_pair.webp" width="40%"/></a>
<figcaption>
    RDMA 通信队列
    <br/><small>
<a href="https://www.snia.org/sites/default/education/tutorials/2008/spring/networking/Goldenberg-D_InfiniBand_Technology_Overview.pdf">InfiniBand Technology Overview - SNIA</a>
</small></figcaption></figure>
<h4 id="_15">访存模式<a class="headerlink" href="#_15" title="Permanent link">¶</a></h4>
<p>RDMA 支持两种访存模式：</p>
<ul>
<li>单边（one-sided）：<strong>read、write、atomic</strong> 操作。<ul>
<li>被动方注册一块内存区域，然后将控制权交给主动方；主动方使用 RDMA Read/Write 操作这块内存区域。</li>
<li><strong>被动方不会使用 CPU 资源</strong>，不会知道 read、write 操作的发生。</li>
<li>WR 必须包含远端的<strong>虚拟内存地址</strong>和 <strong>R_key</strong>，主动方必须提前知道这些信息。</li>
</ul>
</li>
<li>双边（two-sided）：<strong>send、receive</strong> 操作。<ul>
<li>源和目的应用都需要主动参与通信。双方都需要创建 QP 和 CQ。</li>
<li>一方发送 receive，则对端需要发送 send，来消耗（consume）这个 receive。</li>
<li>接收方需要先发送自己接收的数据结构，然后发送端按照这个数据结构发送数据。这意味着接收方的缓冲区和数据结构对发送方不可见。</li>
</ul>
</li>
</ul>
<p>在单个连接中，可以<strong>混用并匹配（mix and match）</strong>这两种模式。</p>
<h4 id="_16">内核旁路<a class="headerlink" href="#_16" title="Permanent link">¶</a></h4>
<p>RDMA 提供内核旁路（kernel bypass）功能：</p>
<ul>
<li>原先由 CPU 负责的分片、可靠性、重传等功能，现在由适配器负责。</li>
<li>RDMA 硬件和驱动具有特殊的设计，可以安全地将硬件映射到用户空间，让应用程序直接访问硬件资源。</li>
<li>数据通路直接从用户空间到硬件，但控制通路仍然通过内核，包括资源管理、状态监控和清理等。保证系统安全稳定。</li>
</ul>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>事实上，通信双方的 QP 被直接映射到了用户空间，因此相当于直接访问对方的内存。</p>
<p>如果你对操作系统和硬件驱动有一些了解，不妨想一想下面的问题：</p>
<ul>
<li>如何才能让应用程序直接访问硬件资源，同时实现操作系统提供的应用隔离和保护呢？</li>
<li>如果在两个独立的虚拟内存空间（可能在不同物理机、不同架构上）之间建立联系？</li>
</ul>
</div>
<h2 id="_17">实用工具<a class="headerlink" href="#_17" title="Permanent link">¶</a></h2>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-12-1"><a href="#__codelineno-12-1" id="__codelineno-12-1" name="__codelineno-12-1"></a>show_gids
</span></code></pre></div>
<h3 id="perftest">perftest<a class="headerlink" href="#perftest" title="Permanent link">¶</a></h3>
<p>需要熟练掌握使用 perftest 套件测试各类指标。以最常用的 <code>ib_send_bw</code> 为例：</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-13-1"><a href="#__codelineno-13-1" id="__codelineno-13-1" name="__codelineno-13-1"></a>ib_send_bw
</span></code></pre></div>
<h2 id="_18">通信框架<a class="headerlink" href="#_18" title="Permanent link">¶</a></h2>
<h3 id="nccl">NCCL<a class="headerlink" href="#nccl" title="Permanent link">¶</a></h3>
<ul>
<li><a href="https://arxiv.org/abs/2507.04786">[2507.04786] Demystifying NCCL: An In-depth Analysis of GPU Communication Protocols and Algorithms</a></li>
</ul>
<h3 id="hccl">HCCL<a class="headerlink" href="#hccl" title="Permanent link">¶</a></h3>
<h3 id="tccl">TCCL<a class="headerlink" href="#tccl" title="Permanent link">¶</a></h3>
<h2 id="_19">文献阅读<a class="headerlink" href="#_19" title="Permanent link">¶</a></h2>
<h3 id="eurosys20-strom-smart-remote-memory">EuroSys’20 <a href="https://doi.org/10.1145/3342195.3387519">StRoM: Smart Remote Memory</a><a class="headerlink" href="#eurosys20-strom-smart-remote-memory" title="Permanent link">¶</a></h3>
<p>基于 FPGA 的 SmartNIC。扩展 IB Verbs，将 RPC 操作 Offload 到远端 SmartNIC 上执行。好处是能够将多次 RTT 的操作合并为一次 RTT，到靠近数据的地方执行。</p>
<p>系统由三个部分构成：</p>
<ul>
<li>RoCE 网络栈</li>
<li>StRoM 可编程 Kernel</li>
<li>DMA 引擎</li>
</ul>
<p>论文中的典型应用场景：</p>
<ul>
<li>KV 存储：在 NIC 上通过 DMA 读哈希表和获取数据。</li>
</ul>
<p>一些知识点：</p>
<ul>
<li>RDMA 操作使用<strong>虚拟内存地址</strong>，但是 PCIe 访问主存使用<strong>物理内存地址</strong>。因此 SmartNIC 上需要一个 TLB。</li>
</ul>
<p>Resources on BlueField 2 Smart NICs: <a href="https://gist.github.com/aagontuk/cf01763c8ee26383afe10f51c9cd2984">https://gist.github.com/aagontuk/cf01763c8ee26383afe10f51c9cd2984</a></p>
<ul>
<li>交换芯片 BlueField：用于 DPU 产品线，简单来说就是网卡上有独立的 CPU，可以处理网络流量。例如，下面是 BlueField-2 DPU 的架构图：</li>
</ul>
<figure>
<a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="auto" href="index.assets/rdma_bf2_arch.webp"><img align="center" alt="rdma_bf2_arch" src="index.assets/rdma_bf2_arch.webp" width="50%"/></a>
<figcaption>
    BlueField-2 DPU 架构
    <br/><small>
<a href="https://infohub.delltechnologies.com/en-us/l/dpus-in-the-new-vsphere-8-0-and-16th-generation-dell-poweredge-servers/nvidia-bluefield-dpu-architecture/">Nvidia Bluefield DPU Architecture - DELL</a>
</small></figcaption></figure>
<h2 id="_20">问题记录<a class="headerlink" href="#_20" title="Permanent link">¶</a></h2>
<h3 id="_21">编译相关<a class="headerlink" href="#_21" title="Permanent link">¶</a></h3>
<ul>
<li>
<p>编译 DPDK 时</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-14-1"><a href="#__codelineno-14-1" id="__codelineno-14-1" name="__codelineno-14-1"></a>Generating drivers/rte_common_ionic.pmd.c with a custom command
</span><span id="__span-14-2"><a href="#__codelineno-14-2" id="__codelineno-14-2" name="__codelineno-14-2"></a>FAILED: drivers/rte_common_ionic.pmd.c
</span><span id="__span-14-3"><a href="#__codelineno-14-3" id="__codelineno-14-3" name="__codelineno-14-3"></a>...
</span><span id="__span-14-4"><a href="#__codelineno-14-4" id="__codelineno-14-4" name="__codelineno-14-4"></a>Exception: elftools module not found
</span></code></pre></div>
<p>解决方法：<code>pip</code> 安装 <code>pyelftools</code> 模块</p>
</li>
</ul>
<h2 id="_22">其他相关知识<a class="headerlink" href="#_22" title="Permanent link">¶</a></h2>
<ul>
<li>DMA 机制：包括 IOVA、VFIO 等。</li>
<li>Linux 内存管理机制：包括 Hugepage、NUMA 等。</li>
<li>Linux 资源分配机制：包括 cgroup 等。</li>
<li>
<p>基础线程库 pthread。</p>
</li>
<li>
<p>Non-Uniform Memory Access (NUMA)：非一致性内存访问。</p>
<ul>
<li>与 UMA 相比的优劣：内存带宽增大，需要编程者考虑局部性</li>
<li>每块内存有<ul>
<li>home：物理上持有该地址空间的处理器</li>
<li>owner：持有该块内存值（写了该块内存）的处理器</li>
</ul>
</li>
<li>Linux NUMA：<a href="https://docs.kernel.org/mm/numa.html">https://docs.kernel.org/mm/numa.html</a><ul>
<li>Cache Coherent NUMA</li>
<li>硬件资源划分为 node<ul>
<li>隐藏了一些细节，不能预期同个 node 上的访存效率相同</li>
<li>每个 node 有自己的内存管理系统</li>
<li>Linux 会尽可能为任务分配 node-local 内存</li>
<li>在足够不平衡的条件下，scheduler 会将任务迁移到其他 node，造成访存效率下降</li>
</ul>
</li>
<li>Memory Policy</li>
</ul>
</li>
<li>Linux 实践<ul>
<li><code>numactl</code></li>
<li><code>lstopo</code></li>
</ul>
</li>
</ul>
</li>
<li>
<p>Hugepage</p>
<ul>
<li>受限于 TLB 大小，Hugepage 会减少 TLB miss</li>
<li>场景：随机访存、大型数据结构</li>
<li><a href="https://www.evanjones.ca/hugepages-are-a-good-idea.html">https://www.evanjones.ca/hugepages-are-a-good-idea.html</a></li>
<li><a href="https://rigtorp.se/hugepages/">https://rigtorp.se/hugepages/</a></li>
</ul>
</li>
</ul>
<aside class="md-source-file">
<span class="md-source-file__fact">
<span class="md-icon" title="Last update">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"></path></svg>
</span>
<span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date" title="August 3, 2025 08:12:26 UTC">August 3, 2025</span>
</span>
</aside>
</article>
</div>
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
</div>
<button class="md-top md-icon" data-md-component="top" hidden="" type="button">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"></path></svg>
  Back to top
</button>
</main>
<footer class="md-footer">
<nav aria-label="Footer" class="md-footer__inner md-grid">
<a aria-label="Previous: 性能分析工具" class="md-footer__link md-footer__link--prev" href="../%E6%80%A7%E8%83%BD%E5%88%86%E6%9E%90%E4%B8%8E%E8%B0%83%E4%BC%98/tools/">
<div class="md-footer__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg>
</div>
<div class="md-footer__title">
<span class="md-footer__direction">
                Previous
              </span>
<div class="md-ellipsis">
                性能分析工具
              </div>
</div>
</a>
<a aria-label="Next: 通信算法" class="md-footer__link md-footer__link--next" href="algorithm/">
<div class="md-footer__title">
<span class="md-footer__direction">
                Next
              </span>
<div class="md-ellipsis">
                通信算法
              </div>
</div>
<div class="md-footer__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"></path></svg>
</div>
</a>
</nav>
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-copyright">
<div class="md-copyright__highlight">
<a href="https://beian.miit.gov.cn/" target="_blank">浙ICP备2022036274号-1</a>
</div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
      Material for MkDocs
    </a>
</div>
<div class="md-social">
<a class="md-social__link" href="https://bowling233.com" rel="noopener" target="_blank" title="bowling233.com">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19.07 4.93C17.22 3 14.66 1.96 12 2c-2.66-.04-5.21 1-7.06 2.93C3 6.78 1.96 9.34 2 12c-.04 2.66 1 5.21 2.93 7.06C6.78 21 9.34 22.04 12 22c2.66.04 5.21-1 7.06-2.93C21 17.22 22.04 14.66 22 12c.04-2.66-1-5.22-2.93-7.07M17 12v6h-3.5v-5h-3v5H7v-6H5l7-7 7.5 7z"></path></svg>
</a>
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<script id="__config" type="application/json">{"base": "../..", "features": ["content.code.copy", "content.code.select", "content.code.annotate", "navigation.footer", "navigation.tabs", "navigation.sections", "navigation.expand", "navigation.indexes", "navigation.tracking", "navigation.path", "navigation.top", "toc.follow", "content.action.edit", "search.suggest", "search.highlight", "search.share"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
<script src="../../assets/javascripts/bundle.92b07e13.min.js"></script>
<script src="../../javascripts/mathjax.js"></script>
<script src="https://polyfill.alicdn.com/polyfill.min.js?features=es6"></script>
<script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<script src="https://unpkg.com/tablesort/dist/tablesort.min.js"></script>
<script src="../../javascripts/tablesort.js"></script>
<script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
<script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script><script src="https://viewer.diagrams.net/js/viewer-static.min.js"></script></body>
</html>